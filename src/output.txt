
================================================================================
File: main\java\com\example\healthhub\config\DataInitializer.java
Size: 4.7 kB
================================================================================

package com.example.healthhub.config;

import com.example.healthhub.dao.*;
import com.example.healthhub.model.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.context.event.EventListener;

/**
 * Initializes test data on application startup if tables are empty
 */
@Component
public class DataInitializer {

    @Autowired
    private MemberDAO memberDAO;

    @Autowired
    private AdminDAO adminDAO;

    @Autowired
    private TrainerDAO trainerDAO;

    @Autowired
    private CategoryDAO categoryDAO;

    @Autowired
    private ProgramDAO programDAO;

    @EventListener
    @Transactional
    public void onApplicationEvent(ContextRefreshedEvent event) {
        initializeData();
    }

    private void initializeData() {
        try {
            // Check if data already exists
            if (memberDAO.findAll().size() > 0) {
                System.out.println("✓ Database already initialized. Skipping data initialization.");
                return;
            }

            System.out.println("=== INITIALIZING TEST DATA ===");

            // Create test members
            Member memberUser = new Member("Test Member", "userpass", "userpass", "member@test.com");
            memberUser.setPhone("01123456789");
            memberUser.setMemberType("student");
            memberUser.setYearOfBirth(2000);
            memberUser.setGender("Male");
            memberUser.setIsActive(true);
            memberDAO.save(memberUser);
            System.out.println("✓ Created member: userpass");

            Member memberUser2 = new Member("Alice Johnson", "alice", "alice123", "alice@test.com");
            memberUser2.setPhone("01187654321");
            memberUser2.setMemberType("staff");
            memberUser2.setYearOfBirth(1995);
            memberUser2.setGender("Female");
            memberUser2.setIsActive(true);
            memberDAO.save(memberUser2);
            System.out.println("✓ Created member: alice");

            // Create test admin
            Admin adminUser = new Admin("Admin User", "admin", "admin123", "admin@test.com");
            adminUser.setPhone("0112222222");
            adminUser.setIsActive(true);
            adminDAO.save(adminUser);
            System.out.println("✓ Created admin: admin");

            // Create test trainer
            Trainer trainerUser = new Trainer("John Trainer", "trainer@test.com", "Fitness");
            trainerUser.setUsername("trainer");
            trainerUser.setPassword("trainer123");
            trainerUser.setPhone("0113333333");
            trainerUser.setIsActive(true);
            trainerDAO.save(trainerUser);
            System.out.println("✓ Created trainer: trainer");

            // Create test categories
            Category cardioCategory = new Category("Cardio", "Cardiovascular exercises");
            categoryDAO.save(cardioCategory);
            System.out.println("✓ Created category: Cardio");

            Category strengthCategory = new Category("Strength", "Weight training and resistance exercises");
            categoryDAO.save(strengthCategory);
            System.out.println("✓ Created category: Strength");

            // Create test programs
            Program program1 = new Program("Beginner Cardio", "A 4-week beginner cardio program", 4, 50.0);
            program1.setDifficultyLevel("Beginner");
            program1.setMaxParticipants(20);
            program1.setTrainer(trainerUser);
            program1.setCategory(cardioCategory);
            program1.setIsActive(true);
            programDAO.save(program1);
            System.out.println("✓ Created program: Beginner Cardio");

            Program program2 = new Program("Advanced Strength", "A 6-week advanced strength training program", 6, 75.0);
            program2.setDifficultyLevel("Advanced");
            program2.setMaxParticipants(15);
            program2.setTrainer(trainerUser);
            program2.setCategory(strengthCategory);
            program2.setIsActive(true);
            programDAO.save(program2);
            System.out.println("✓ Created program: Advanced Strength");

            System.out.println("=== TEST DATA INITIALIZATION COMPLETE ===");

        } catch (Exception e) {
            System.err.println("❌ Error initializing test data: " + e.getMessage());
            e.printStackTrace();
        }
    }
}


================================================================================
File: main\java\com\example\healthhub\controller\AdminController.java
Size: 11.14 kB
================================================================================

package com.example.healthhub.controller;

import com.example.healthhub.dao.EnrollmentDAO;
import com.example.healthhub.dao.MemberDAO;
import com.example.healthhub.dao.ProgramDAO;
import com.example.healthhub.dao.BmiRecordDAO;
import com.example.healthhub.model.Member;
import com.example.healthhub.model.Program;
import com.example.healthhub.model.BmiRecord;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.servlet.http.HttpSession;
import java.util.List;
import java.util.stream.Collectors;
import java.util.Map;

@Controller
@RequestMapping("/admin")
public class AdminController {

    @Autowired
    private MemberDAO memberDAO;

    @Autowired
    private BmiRecordDAO bmiRecordDAO;

    @Autowired 
    private EnrollmentDAO enrollmentDAO;

    @Autowired 
    private ProgramDAO programDAO;

    private boolean isAdmin(HttpSession session) {
        String role = (String) session.getAttribute("userrole");
        return "admin".equals(role);
    }

    
    private String checkRoleAndRedirect(HttpSession session) {
        if (!isAdmin(session)) {
            return "redirect:/login"; 
        }
        return null; 
    }

    /**
     * Admin Dashboard - redirects to person list
     */
    @GetMapping("/dashboard")
    public String adminDashboard(HttpSession session) {
        if (!isAdmin(session)) {
            return "redirect:/login";
        }
        try {
            return "admin/dashboard";
        } catch (Exception e) {
            System.err.println("❌ Error loading admin dashboard: " + e.getMessage());
            return "redirect:/login";
        }
    }

    @GetMapping("/person/list")
    public String listPersons(@RequestParam(required = false) String searchName, 
                         Model model, 
                         HttpSession session) {
        if (!isAdmin(session)) {
            return "redirect:/login";
        }
    
        try {
            // Get all members from MemberDAO instead of BMI records
            List<Member> members = memberDAO.findAll();

            // Filter by search term if provided
            if (searchName != null && !searchName.trim().isEmpty()) {
                String q = searchName.trim().toLowerCase();
                members = members.stream()
                        .filter(m -> m.getName() != null && m.getName().toLowerCase().contains(q))
                        .collect(java.util.stream.Collectors.toList());
            }

            // ✅ CRITICAL FIX: Initialize Lazy Collection to prevent view crash
            // The view calls 'p.bmi', which needs 'bmiHistory'.
            for (Member m : members) {
                org.hibernate.Hibernate.initialize(m.getBmiHistory());
            }

            model.addAttribute("persons", members);
        } catch (Exception e) {
            System.err.println("❌ Error loading members list: " + e.getMessage());
            e.printStackTrace();
            model.addAttribute("persons", java.util.List.of());
            model.addAttribute("error", "Failed to load members. Please try again.");
        }
        return "admin/person-list";
    }

    @GetMapping("/person/view/{id}")
    public String viewPerson(@PathVariable("id") Long id, Model model, HttpSession session) {
        System.out.println("=== ADMIN VIEW PERSON ===");
        System.out.println("Viewing member ID: " + id);
        
        if (!isAdmin(session)) {
            return "redirect:/login";
        }
        
        try {
            // Load member directly
            Member member = memberDAO.findById(id);
            
            if (member == null) {
                System.err.println("❌ Member not found with ID: " + id);
                return "redirect:/admin/person/list";
            }
            
            System.out.println("✅ Member loaded: " + member.getName());
            
            // Load BMI history separately
            List<BmiRecord> history = bmiRecordDAO.findByMember(id);
            System.out.println("✅ Found " + history.size() + " BMI records");
            
            model.addAttribute("person", member);
            model.addAttribute("bmiHistory", history);
            
            return "admin/person-view";
            
        } catch (Exception e) {
            System.err.println("❌ Error loading member: " + e.getMessage());
            e.printStackTrace();
            return "redirect:/admin/person/list";
        }
    }

    @GetMapping("/person/new")
public String showCreateMemberForm(Model model, HttpSession session) {
    if (!isAdmin(session)) {
        return "redirect:/login";
    }
    
    // Create empty member object for the form
    Member newMember = new Member();
    model.addAttribute("member", newMember);
    model.addAttribute("isNewMember", true); // Flag for the view
    
    return "admin/person-form"; // New template for create/edit
}

@PostMapping("/person/create")
public String createMember(@ModelAttribute Member memberData,
                          RedirectAttributes redirectAttributes,
                          HttpSession session) {
    if (!isAdmin(session)) {
        return "redirect:/login";
    }
    
    try {
        // Set default values
        memberData.setIsActive(true);
        
        // Save new member
        memberDAO.save(memberData);
        
        redirectAttributes.addFlashAttribute("flashMessage", 
            "Successfully created new member: " + memberData.getName());
        
        return "redirect:/admin/person/list";
        
    } catch (Exception e) {
        System.err.println("❌ Error creating member: " + e.getMessage());
        e.printStackTrace();
        redirectAttributes.addFlashAttribute("errorMessage", 
            "Failed to create member. Please check if username/email already exists.");
        return "redirect:/admin/person/new";
    }
}

@GetMapping("/person/edit/{id}")
public String showEditForm(@PathVariable("id") Long id, Model model, HttpSession session) {
    if (!isAdmin(session)) {
        return "redirect:/login";
    }
    
    Member member = memberDAO.findById(id);
    if (member == null) {
        return "redirect:/admin/person/list";
    }
    
    model.addAttribute("member", member);
    return "admin/person-edit";  // ✅ Maps to: admin/person-edit.html
}

@PostMapping("/person/update")
public String updatePerson(@RequestParam("id") Long id,
                          @ModelAttribute Member memberData, 
                          RedirectAttributes redirectAttributes,
                          HttpSession session) {
    if (!isAdmin(session)) {
        return "redirect:/login";
    }
    
    Member existing = memberDAO.findById(id);
    if (existing == null) {
        redirectAttributes.addFlashAttribute("flashMessage", "Error: Member not found.");
        return "redirect:/admin/person/list";
    }
    
    // Update member fields
    existing.setName(memberData.getName());
    existing.setEmail(memberData.getEmail());
    existing.setPhone(memberData.getPhone());
    existing.setMemberType(memberData.getMemberType());
    existing.setYearOfBirth(memberData.getYearOfBirth());
    existing.setGender(memberData.getGender());
    
    memberDAO.update(existing);
    
    redirectAttributes.addFlashAttribute("flashMessage", "Successfully updated member: " + existing.getName());
    return "redirect:/admin/person/list";
}

    @PostMapping("/person/delete")
public String deleteMember(@RequestParam("id") Long id, 
                          RedirectAttributes redirectAttributes,
                          HttpSession session) {
    if (!isAdmin(session)) {
        return "redirect:/login";
    }
    
    try {
        // Get the member first
        Member member = memberDAO.findById(id);
        
        if (member == null) {
            redirectAttributes.addFlashAttribute("flashMessage", 
                "Error: Member not found.");
            return "redirect:/admin/person/list";
        }
        
        String memberName = member.getName();
        
        // ✅ DELETE THE ACTUAL MEMBER
        // This will cascade delete all related records (BMI, enrollments, workout plans)
        // because of CascadeType.ALL in the Member entity relationships
        memberDAO.delete(id);
        
        redirectAttributes.addFlashAttribute("flashMessage", 
            "Successfully deleted member: " + memberName + " and all associated records.");
        
    } catch (Exception e) {
        System.err.println("❌ Error deleting member: " + e.getMessage());
        e.printStackTrace();
        redirectAttributes.addFlashAttribute("errorMessage", 
            "Failed to delete member. They may have dependent records.");
    }
    
    return "redirect:/admin/person/list";
}

    @GetMapping("/reports")
    public String viewReports(HttpSession session, Model model) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        // --- 1. Fetch KPI Data (Simplified counts) ---
        // Note: Using list size if dedicated count methods for Program/Person are not in DAO
        Long totalPrograms = (long) programDAO.findAll().size(); 
        Long totalUsers = (long) memberDAO.findAll().size();
        Long totalEnrollments = enrollmentDAO.countAllEnrollments(); 

        // --- 2. Fetch Aggregated Data (Top 5 Programs) ---
        // This method returns List<Object[]> where each Object[] contains [Program, Long count]
        List<Object[]> rawReports = enrollmentDAO.findTopEnrolledPrograms(5);
        
        // Convert the raw data into separate structures needed by the view
        List<Program> popularPrograms = rawReports.stream()
            .map(obj -> (Program) obj[0])
            .collect(Collectors.toList());
        
        // Create a map {Program ID: Count} for easy lookup in Thymeleaf
        Map<Long, Long> enrollmentCounts = rawReports.stream()
            .collect(Collectors.toMap(
                obj -> ((Program) obj[0]).getId(), // Key is Program ID
                obj -> (Long) obj[1]              // Value is Enrollment Count
            ));

        // --- 3. Add Data to Model ---
        model.addAttribute("totalPrograms", totalPrograms);
        model.addAttribute("totalEnrollments", totalEnrollments);
        model.addAttribute("totalUsers", totalUsers);
        model.addAttribute("popularPrograms", popularPrograms);
        model.addAttribute("enrollmentCounts", enrollmentCounts); 
        
        model.addAttribute("pageTitle", "System Summary & Enrollment Reports");
        return "admin/reports"; 
    }
}

================================================================================
File: main\java\com\example\healthhub\controller\AuthController.java
Size: 8.49 kB
================================================================================

package com.example.healthhub.controller;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

import com.example.healthhub.dao.MemberDAO;
import com.example.healthhub.dao.TrainerDAO;
import com.example.healthhub.dao.AdminDAO;
import com.example.healthhub.model.Member;
import com.example.healthhub.model.Trainer;
import com.example.healthhub.model.Admin;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class AuthController {

    @Autowired
    private MemberDAO memberDAO;

    @Autowired
    private TrainerDAO trainerDAO;

    @Autowired
    private AdminDAO adminDAO;

    @GetMapping("/")
    public String landing() {
        return "redirect:/login";
    }

    @GetMapping("/login")
    public String showLoginForm(HttpSession session) {
        if (session.getAttribute("username") != null) {
            return "redirect:/home";
        }
        return "login";
    }

    @PostMapping("/login")
    public String processLogin(@RequestParam String username, 
                               @RequestParam String password, 
                               HttpServletRequest request,
                               Model model) {
        
        System.out.println("=== LOGIN ATTEMPT ===");
        System.out.println("Username: " + username);
        
        // Get existing session or create new one
        HttpSession session = request.getSession(true);
        
        // Clear any existing session attributes
        session.removeAttribute("username");
        session.removeAttribute("userrole");
        session.removeAttribute("userId");
        session.removeAttribute("trainerId");
        
        try {
            // Try MEMBER authentication
            Member member = memberDAO.authenticate(username, password);
            if (member != null && member.getIsActive()) {
                session.setAttribute("username", member.getName());
                session.setAttribute("userrole", "member");
                session.setAttribute("userId", member.getId());
                System.out.println("✅ Member login successful: " + member.getName());
                return "redirect:/member/dashboard";
            }
            
            // Try TRAINER authentication
            Trainer trainer = trainerDAO.authenticate(username, password);
            if (trainer != null && trainer.getIsActive()) {
                session.setAttribute("username", trainer.getName());
                session.setAttribute("userrole", "trainer");
                session.setAttribute("userId", trainer.getId());
                session.setAttribute("trainerId", trainer.getId());
                System.out.println("✅ Trainer login successful: " + trainer.getName());
                return "redirect:/trainer/dashboard";
            }
            
            // Try ADMIN authentication
            Admin admin = adminDAO.authenticate(username, password);
            if (admin != null && admin.getIsActive()) {
                session.setAttribute("username", admin.getName());
                session.setAttribute("userrole", "admin");
                session.setAttribute("userId", admin.getId());
                System.out.println("✅ Admin login successful: " + admin.getName());
                return "redirect:/admin/dashboard";
            }
            
            // If no match found
            System.out.println("❌ Login failed - invalid credentials");
            model.addAttribute("errorMessage", "Invalid username or password.");
            return "login";
            
        } catch (Exception e) {
            System.err.println("❌ Login error: " + e.getMessage());
            e.printStackTrace();
            model.addAttribute("errorMessage", "Login failed. Please try again.");
            return "login";
        }
    }

    @GetMapping("/home")
    public String home(HttpSession session) {
        System.out.println("=== /home accessed ===");
        System.out.println("Session ID: " + session.getId());
        System.out.println("Username in session: " + session.getAttribute("username"));
        System.out.println("Role in session: " + session.getAttribute("userrole"));
        
        if (session.getAttribute("username") == null) {
            System.out.println("No username found, redirecting to login");
            return "redirect:/login";
        }
        
        String role = (String) session.getAttribute("userrole");
        if ("admin".equals(role)) {
            return "redirect:/admin/dashboard";
        } else if ("trainer".equals(role)) {
            return "redirect:/trainer/dashboard";
        } else if ("member".equals(role)) {
            return "redirect:/member/dashboard";
        }
        
        return "index";
    }

    @GetMapping("/register")
public String showRegisterForm(Model model, HttpSession session) {
    // Redirect to home if already logged in
    if (session.getAttribute("username") != null) {
        return "redirect:/home";
    }
    
    model.addAttribute("member", new Member());
    return "register";
}

@PostMapping("/register")
public String processRegistration(@ModelAttribute Member memberData,
                                 BindingResult result,
                                 Model model,
                                 HttpServletRequest request) {
    
    System.out.println("=== REGISTRATION ATTEMPT ===");
    System.out.println("Username: " + memberData.getUsername());
    
    // Basic validation
    if (memberData.getName() == null || memberData.getName().trim().isEmpty()) {
        model.addAttribute("errorMessage", "Name is required.");
        return "register";
    }
    
    if (memberData.getUsername() == null || memberData.getUsername().trim().isEmpty()) {
        model.addAttribute("errorMessage", "Username is required.");
        return "register";
    }
    
    if (memberData.getPassword() == null || memberData.getPassword().trim().isEmpty()) {
        model.addAttribute("errorMessage", "Password is required.");
        return "register";
    }
    
    if (memberData.getEmail() == null || memberData.getEmail().trim().isEmpty()) {
        model.addAttribute("errorMessage", "Email is required.");
        return "register";
    }
    
    try {
        // Check if username already exists
        Member existingUser = memberDAO.findByUsername(memberData.getUsername());
        if (existingUser != null) {
            model.addAttribute("errorMessage", "Username already taken. Please choose another.");
            model.addAttribute("member", memberData);
            return "register";
        }
        
        // Set default values for new member
        memberData.setIsActive(true);
        
        // Save new member
        memberDAO.save(memberData);
        
        System.out.println("✅ Registration successful: " + memberData.getName());
        
        // Auto-login after successful registration
        HttpSession session = request.getSession(true);
        session.setAttribute("username", memberData.getName());
        session.setAttribute("userrole", "member");
        session.setAttribute("userId", memberData.getId());
        
        return "redirect:/member/dashboard";
        
    } catch (Exception e) {
        System.err.println("❌ Registration error: " + e.getMessage());
        e.printStackTrace();
        model.addAttribute("errorMessage", "Registration failed. Username or email may already exist.");
        model.addAttribute("member", memberData);
        return "register";
    }
}

    @GetMapping("/logout")
    public String logout(HttpSession session) {
        System.out.println("=== LOGOUT ===");
        System.out.println("Invalidating session: " + session.getId());
        session.invalidate();
        return "redirect:/login?logoutMsg=You have successfully logged out.";
    }
}

================================================================================
File: main\java\com\example\healthhub\controller\BmiController.java
Size: 6.76 kB
================================================================================

package com.example.healthhub.controller;

import javax.servlet.http.HttpSession;
import javax.validation.Valid;

import com.example.healthhub.dao.BmiRecordDAO;
import com.example.healthhub.dao.MemberDAO;
import com.example.healthhub.model.BmiRecord;
import com.example.healthhub.model.Member;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

import java.util.List;

@Controller
@RequestMapping("/bmi")
public class BmiController {

    @Autowired
    private BmiRecordDAO bmiRecordDAO;

    @Autowired
    private MemberDAO memberDAO;
    
    // Constructor for debugging
    public BmiController() {
        System.out.println("========================================");
        System.out.println("✅ BmiController INITIALIZED!");
        System.out.println("========================================");
    }

    @RequestMapping(value = "/form", method = RequestMethod.GET)
    public String showForm(Model model, HttpSession session) {
        System.out.println("=== BMI FORM GET REQUEST ===");
        
        String role = (String) session.getAttribute("userrole");
        Long userId = (Long) session.getAttribute("userId");
        
        if (!"member".equals(role) || userId == null) {
            System.out.println("❌ Access denied - not a member");
            model.addAttribute("errorMessage", "Only members can access the BMI calculator.");
            return "redirect:/login";
        }
        
        BmiRecord emptyRecord = new BmiRecord();
        
        try {
            Member member = memberDAO.findById(userId);
            if (member != null) {
                emptyRecord.setName(member.getName());
                emptyRecord.setGender(member.getGender());
                emptyRecord.setYearOfBirth(member.getYearOfBirth());
                System.out.println("✅ Pre-filled form for: " + member.getName());
            }
        } catch (Exception e) {
            System.err.println("Could not pre-fill member info: " + e.getMessage());
        }
        
        model.addAttribute("bmiRecord", emptyRecord);
        return "bmi-form";
    }

    @RequestMapping(value = "/calculate", method = RequestMethod.POST)
    public String calculateBmi(@ModelAttribute("bmiRecord") @Valid BmiRecord bmiRecord,
                              BindingResult bindingResult,
                              @RequestParam(value = "interests", required = false) String[] interests,
                              HttpSession session,
                              Model model) {
        
        System.out.println("========================================");
        System.out.println("=== BMI CALCULATE POST REQUEST RECEIVED ===");
        System.out.println("Height: " + (bmiRecord.getHeight() != null ? bmiRecord.getHeight() : "NULL"));
        System.out.println("Weight: " + (bmiRecord.getWeight() != null ? bmiRecord.getWeight() : "NULL"));
        System.out.println("========================================");
        
        String role = (String) session.getAttribute("userrole");
        Long userId = (Long) session.getAttribute("userId");
        
        if (!"member".equals(role) || userId == null) {
            System.out.println("❌ Access denied - not a member");
            model.addAttribute("errorMessage", "Only members can calculate BMI.");
            return "redirect:/login";
        }
        
        if (bindingResult.hasErrors()) {
            System.out.println("❌ Validation errors found!");
            bindingResult.getAllErrors().forEach(error -> 
                System.out.println("Error: " + error.toString())
            );
            return "bmi-form";
        }

        bmiRecord.setInterestsArray(interests);
        
        try {
            Member member = memberDAO.findById(userId);
            if (member != null) {
                bmiRecord.setMember(member);
                System.out.println("✅ BMI record linked to member: " + member.getName());
            } else {
                System.err.println("❌ Member not found with ID: " + userId);
                model.addAttribute("errorMessage", "Member account not found.");
                return "bmi-form";
            }
        } catch (Exception e) {
            System.err.println("❌ Error linking BMI to member: " + e.getMessage());
            e.printStackTrace();
            model.addAttribute("errorMessage", "Error processing BMI calculation.");
            return "bmi-form";
        }
        
        try {
            bmiRecordDAO.save(bmiRecord);
            System.out.println("✅ BMI record saved! ID: " + bmiRecord.getId());
            model.addAttribute("message", "BMI calculated and saved successfully!");
        } catch (Exception e) {
            System.err.println("❌ ERROR saving BMI record: " + e.getMessage());
            e.printStackTrace();
            model.addAttribute("errorMessage", "Error saving data: " + e.getMessage());
            return "bmi-form";
        }

        System.out.println("=== BMI CALCULATE COMPLETE - REDIRECTING TO RESULT ===");
        
        model.addAttribute("bmiRecord", bmiRecord);
        return "bmi-result";
    }

    @RequestMapping(value = "/history", method = RequestMethod.GET)
    public String viewHistory(Model model, HttpSession session) {
        String role = (String) session.getAttribute("userrole");
        Long userId = (Long) session.getAttribute("userId");
        
        if (!"member".equals(role) || userId == null) {
            return "redirect:/login";
        }
        
        try {
            List<BmiRecord> history = bmiRecordDAO.findByMember(userId);
            model.addAttribute("bmiHistory", history);
            
            Member member = memberDAO.findById(userId);
            model.addAttribute("member", member);
            
            System.out.println("✅ Loaded " + history.size() + " BMI records for member " + userId);
        } catch (Exception e) {
            System.err.println("❌ Error loading BMI history: " + e.getMessage());
            model.addAttribute("bmiHistory", List.of());
        }
        
        return "member/bmi-history";
    }

}

================================================================================
File: main\java\com\example\healthhub\controller\CategoryController.java
Size: 3.31 kB
================================================================================

package com.example.healthhub.controller;

import com.example.healthhub.dao.CategoryDAO;
import com.example.healthhub.model.Category;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.servlet.http.HttpSession;
import java.util.List;

@Controller
@RequestMapping("/admin/categories")
public class CategoryController {

    @Autowired
    private CategoryDAO categoryDAO;

    private boolean isAdmin(HttpSession session) {
        String role = (String) session.getAttribute("userrole");
        return "admin".equals(role);
    }

    private String checkRoleAndRedirect(HttpSession session) {
        if (!isAdmin(session)) {
            return "redirect:/login";
        }
        return null;
    }

    @GetMapping("/list")
    public String listCategories(HttpSession session, Model model) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        List<Category> categories = categoryDAO.findAll();
        model.addAttribute("categories", categories);
        model.addAttribute("pageTitle", "Manage Categories");
        return "admin/category-list";
    }

    @GetMapping({"/new", "/edit/{id}"})
    public String showForm(@PathVariable(required = false) Long id, HttpSession session, Model model) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        Category category = (id == null) ? new Category() : categoryDAO.findById(id);
        model.addAttribute("category", category);
        model.addAttribute("pageTitle", (id == null) ? "Add New Category" : "Edit Category");
        return "admin/category-form";
    }

    @PostMapping("/save")
    public String saveCategory(@ModelAttribute Category category, HttpSession session, RedirectAttributes redirectAttributes) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        if (category.getId() == null) {
            categoryDAO.save(category);
            redirectAttributes.addFlashAttribute("flashMessage", "Category created successfully!");
        } else {
            categoryDAO.update(category);
            redirectAttributes.addFlashAttribute("flashMessage", "Category updated successfully!");
        }

        return "redirect:/admin/categories/list";
    }

    @GetMapping("/delete/{id}")
    public String deleteCategory(@PathVariable("id") Long id, HttpSession session, RedirectAttributes redirectAttributes) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        Category category = categoryDAO.findById(id);
        if (category != null) {
            categoryDAO.delete(id);
            redirectAttributes.addFlashAttribute("flashMessage", "Category '" + category.getName() + "' deleted.");
        } else {
            redirectAttributes.addFlashAttribute("flashMessage", "Category not found.");
        }

        return "redirect:/admin/categories/list";
    }

}


================================================================================
File: main\java\com\example\healthhub\controller\MemberController.java
Size: 8.79 kB
================================================================================

package com.example.healthhub.controller;

import com.example.healthhub.dao.ProgramDAO;
import com.example.healthhub.dao.BmiRecordDAO;
import com.example.healthhub.dao.EnrollmentDAO;
import com.example.healthhub.dao.MemberDAO;
import com.example.healthhub.dao.WorkoutPlanDAO;
import com.example.healthhub.model.Program;
import com.example.healthhub.model.BmiRecord;
import com.example.healthhub.model.Enrollment;
import com.example.healthhub.model.Member;
import com.example.healthhub.model.WorkoutPlan;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.servlet.http.HttpSession;
import java.util.List;

@Controller
@RequestMapping("/member")
public class MemberController {
    
    @Autowired
    private ProgramDAO programDAO;
    
    @Autowired
    private EnrollmentDAO enrollmentDAO;
    
    @Autowired
    private MemberDAO memberDAO;

    @Autowired
    private WorkoutPlanDAO workoutPlanDAO;

    @Autowired
    private BmiRecordDAO bmiRecordDAO;

    @GetMapping("/dashboard")
    public String memberDashboard(Model model, HttpSession session) {
        String role = (String) session.getAttribute("userrole");
        if (!"member".equals(role)) {
            return "redirect:/login";
        }
        
        Long userId = (Long) session.getAttribute("userId");
        // ✅ CRITICAL FIX: Handle case where session ID might be missing/null
        if (userId == null) {
            return "redirect:/login";
        }
        
        try {
            // Get member info
            Member member = memberDAO.findById(userId);
            
            // Get enrollment statistics
            List<Enrollment> enrollments = enrollmentDAO.findByMember(userId);
            long activeEnrollments = enrollments.stream()
                .filter(e -> "Active".equals(e.getStatus()))
                .count();
            long pendingPayments = enrollments.stream()
                .filter(e -> "Pending".equals(e.getPaymentStatus()))
                .count();
            
            // Get workout plan info
            List<WorkoutPlan> plans = workoutPlanDAO.findByMember(userId);
            
            WorkoutPlan activePlan = plans.stream()
                // ✅ CRITICAL FIX: Safe Boolean check to prevent NullPointerException
                .filter(p -> Boolean.TRUE.equals(p.getIsActive())) 
                .findFirst()
                .orElse(null);
            
            // Get total available programs
            long totalPrograms = programDAO.findActivePrograms().size();
            
            model.addAttribute("member", member);
            model.addAttribute("activeEnrollments", activeEnrollments);
            model.addAttribute("pendingPayments", pendingPayments);
            model.addAttribute("activePlan", activePlan);
            model.addAttribute("totalPrograms", totalPrograms);
            
        } catch (Exception e) {
            System.err.println("Error loading dashboard: " + e.getMessage());
            model.addAttribute("activeEnrollments", 0L);
            model.addAttribute("pendingPayments", 0L);
            model.addAttribute("activePlan", null);
            model.addAttribute("totalPrograms", 0L);
        }

        List<BmiRecord> bmiHistory = bmiRecordDAO.findByMember(userId);
        if (!bmiHistory.isEmpty()) {
            BmiRecord latestBmi = bmiHistory.get(0);
            model.addAttribute("latestBmi", latestBmi);
            model.addAttribute("bmiRecordCount", bmiHistory.size());
        }
        
        return "member/dashboard";
    }

    @GetMapping("/programs")
    public String listPrograms(Model model, HttpSession session) {
        if (!"member".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }
        
        try {
            List<Program> programs = programDAO.findActivePrograms();
            model.addAttribute("programs", programs);
        } catch (Exception e) {
            System.out.println("⚠️ Could not load programs from DB");
            model.addAttribute("programs", List.of());
        }
        
        return "member/program-list";
    }
    
    @GetMapping("/enrollments")
    public String myEnrollments(Model model, HttpSession session) {
        if (!"member".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }
        
        Long userId = (Long) session.getAttribute("userId");
        if (userId == null) return "redirect:/login";
        
        try {
            List<Enrollment> enrollments = enrollmentDAO.findByMember(userId);
            model.addAttribute("enrollments", enrollments);
        } catch (Exception e) {
            System.out.println("⚠️ Could not load enrollments from DB");
            model.addAttribute("enrollments", List.of());
        }
        
        return "member/my-enrollments";
    }

    @GetMapping("/enroll-form")
    public String showEnrollmentForm(Model model, HttpSession session) {
        if (!"member".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }
        
        try {
            List<Program> programs = programDAO.findActivePrograms();
            model.addAttribute("programs", programs);
        } catch (Exception e) {
            System.out.println("⚠️ Could not load programs from DB");
            model.addAttribute("programs", List.of());
        }
        
        model.addAttribute("enrollment", new Enrollment());
        return "member/enroll-form";
    }

    @PostMapping("/enroll")
    public String enrollInProgram(@RequestParam("programId") Long programId, 
                                  HttpSession session,
                                  RedirectAttributes redirectAttributes) {
        if (!"member".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }

        Long userId = (Long) session.getAttribute("userId");
        if (userId == null) return "redirect:/login";
        
        try {
            Member member = memberDAO.findById(userId);
            Program program = programDAO.findById(programId);
            
            if (member == null || program == null) {
                redirectAttributes.addFlashAttribute("error", "Error: Invalid enrollment data.");
                return "redirect:/member/enroll-form";
            }
            
            Enrollment newEnrollment = new Enrollment(member, program);
            newEnrollment.setStartDate(newEnrollment.getEnrollmentDate().plusDays(7));
            enrollmentDAO.save(newEnrollment);
            
            redirectAttributes.addFlashAttribute("success", 
                "Successfully enrolled in " + program.getName() + "!");
        } catch (Exception e) {
            System.out.println("⚠️ Enrollment failed: " + e.getMessage());
            redirectAttributes.addFlashAttribute("error", "Enrollment failed. Please try again.");
        }
        
        return "redirect:/member/enrollments";
    }

    @GetMapping("/workout-plans")
    public String workoutPlans(Model model, HttpSession session) {
        if (!"member".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }
        
        Long userId = (Long) session.getAttribute("userId");
        if (userId == null) return "redirect:/login";
        
        try {
            List<WorkoutPlan> memberPlans = workoutPlanDAO.findByMember(userId);
            
            WorkoutPlan currentPlan = memberPlans.stream()
                // ✅ CRITICAL FIX: Safe Boolean check to prevent NullPointerException
                .filter(p -> Boolean.TRUE.equals(p.getIsActive()))
                .findFirst()
                .orElse(null);
                
            model.addAttribute("currentPlan", currentPlan);
            model.addAttribute("allPlans", memberPlans);
        } catch (Exception e) {
            System.out.println("⚠️ Could not load workout plans from DB");
            model.addAttribute("currentPlan", null);
            model.addAttribute("allPlans", List.of());
        }
        
        return "member/workout-plans";
    }
}

================================================================================
File: main\java\com\example\healthhub\controller\ProgramController.java
Size: 6.7 kB
================================================================================

package com.example.healthhub.controller;

import com.example.healthhub.dao.CategoryDAO;
import com.example.healthhub.dao.ProgramDAO;
import com.example.healthhub.dao.TrainerDAO;
import com.example.healthhub.model.Program;
import com.example.healthhub.model.Category;
import com.example.healthhub.model.Trainer;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.servlet.http.HttpSession;
import java.util.List;

/**
 * Controller for the Admin to manage Fitness Programs (CRUD).
 */
@Controller
@RequestMapping("/admin/programs")
public class ProgramController {

    @Autowired
    private ProgramDAO programDAO;

    @Autowired
    private CategoryDAO categoryDAO; 

    @Autowired
    private TrainerDAO trainerDAO;

    /**
     * Helper method to check if the current user session has the 'admin' role.
     */
    private boolean isAdmin(HttpSession session) {
        String role = (String) session.getAttribute("userrole");
        return "admin".equals(role);
    }
    
    /**
     * Checks role and returns the redirect path to login if unauthorized, or null to proceed.
     */
    private String checkRoleAndRedirect(HttpSession session) {
        if (!isAdmin(session)) {
            return "redirect:/login"; 
        }
        return null; 
    }

    // --- LIST ALL PROGRAMS (READ) ---
    @GetMapping("/list")
    public String listPrograms(HttpSession session, Model model) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        List<Program> programs = programDAO.findAll();
        model.addAttribute("programs", programs);
        model.addAttribute("pageTitle", "Manage Fitness Programs");
        model.addAttribute("isFilteredView", false);
        return "admin/program-list"; // Maps to /templates/admin/program-list.html
    }

    // --- SHOW ADD/EDIT FORM (CREATE/UPDATE) ---
    @GetMapping({"/new", "/edit/{id}"})
    public String showForm(@PathVariable(required = false) Long id, HttpSession session, Model model) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        Program program = (id == null) ? new Program() : programDAO.findById(id);
        
        // Load all categories for the dropdown menu in the program form
        List<Category> categories = categoryDAO.findAll();
        List<Trainer> trainers = trainerDAO.findAll();
        
        model.addAttribute("program", program);
        model.addAttribute("categories", categories);
        model.addAttribute("trainers", trainers);
        model.addAttribute("pageTitle", (id == null) ? "Add New Program" : "Edit Program");
        
        return "admin/program-form"; // Maps to /templates/admin/program-form.html
    }

    // --- SAVE/UPDATE PROGRAM (CREATE/UPDATE) ---
    @PostMapping("/save")
    public String saveProgram(@ModelAttribute Program program, 
                              @RequestParam("categoryId") Long categoryId, 
                              HttpSession session, 
                              RedirectAttributes redirectAttributes) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        // Fetch the Category object and link it to the Program before saving
        Category category = categoryDAO.findById(categoryId);
        program.setCategory(category);
        
        if (program.getId() == null) {
            programDAO.save(program);
            redirectAttributes.addFlashAttribute("flashMessage", "Program created successfully!");
        } else {
            programDAO.update(program);
            redirectAttributes.addFlashAttribute("flashMessage", "Program updated successfully!");
        }
        
        return "redirect:/admin/programs/list";
    }

    // --- DELETE PROGRAM (DELETE) ---
    @GetMapping("/delete/{id}")
    public String deleteProgram(@PathVariable("id") Long id, HttpSession session, RedirectAttributes redirectAttributes) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        Program program = programDAO.findById(id);
        if (program != null) {
            programDAO.delete(id);
            redirectAttributes.addFlashAttribute("flashMessage", 
                "Program '" + program.getName() + "' deleted successfully.");
        } else {
            redirectAttributes.addFlashAttribute("flashMessage", "Error: Program not found.");
        }
        
        return "redirect:/admin/programs/list";
    }

    @GetMapping("/viewByCategory/{categoryId}")
    public String viewProgramsByCategory(@PathVariable("categoryId") Long categoryId, HttpSession session, Model model) {
        // Check for Admin role (assuming checkRoleAndRedirect exists in this class)
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        // Assuming programDAO has findByCategory(Long categoryId) method
        List<Program> programs = programDAO.findByCategory(categoryId);
    
        // Fetch the category name for the page title
        Category category = categoryDAO.findById(categoryId); 

        model.addAttribute("programs", programs);
        model.addAttribute("pageTitle", "Programs in Category: " + category.getName());
        // IMPORTANT: Add flag to show the back button in the view
        model.addAttribute("isFilteredView", true); 
    
        // Use the existing program list view
        return "admin/program-list";
}

// Maps to: /admin/programs/view/{id}
    @GetMapping("/view/{id}")
    public String viewProgram(@PathVariable("id") Long id, HttpSession session, Model model) {
        String redirect = checkRoleAndRedirect(session);
        if (redirect != null) return redirect;

        Program program = programDAO.findById(id);
        
        if (program == null) {
            // Handle case where program is not found
            model.addAttribute("errorMessage", "Program not found.");
            return "redirect:/admin/programs/list"; 
        }

        model.addAttribute("program", program);
        model.addAttribute("pageTitle", "Program Details: " + program.getName());
        
        // This returns the new detail view page
        return "admin/program-view"; 
    }

}

================================================================================
File: main\java\com\example\healthhub\controller\TrainerController.java
Size: 14.86 kB
================================================================================

package com.example.healthhub.controller;

import com.example.healthhub.dao.WorkoutPlanDAO;
import com.example.healthhub.dao.MemberDAO;
import com.example.healthhub.dao.TrainerDAO;
import com.example.healthhub.model.WorkoutPlan;
import com.example.healthhub.model.Trainer;
import com.example.healthhub.model.Member;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

import javax.servlet.http.HttpSession;
import javax.validation.Valid;
import java.util.List;

@Controller
@RequestMapping("/trainer")
public class TrainerController {
    
    @Autowired
    private WorkoutPlanDAO workoutPlanDAO;
    
    @Autowired
    private MemberDAO memberDAO;

    @Autowired
    private TrainerDAO trainerDAO;

    /**
     * Trainer Dashboard - displays trainer profile and statistics
     */
    @GetMapping("/dashboard")
    public String dashboard(Model model, HttpSession session) {
        System.out.println("=== TRAINER DASHBOARD ACCESS ===");
        
        // 1. Check if user is logged in as trainer
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            System.out.println("❌ Not authenticated as trainer - redirecting to login");
            return "redirect:/login";
        }
        
        Long trainerId = (Long) session.getAttribute("trainerId");
        
        // 2. Defensive check for null trainerId
        if (trainerId == null) {
            System.err.println("❌ ERROR: Trainer ID is null in session!");
            session.invalidate();
            return "redirect:/login";
        }

        System.out.println("✅ Loading trainer dashboard for ID: " + trainerId);
        
        // 3. Try to fetch trainer from database with fallback to mock data
        Trainer trainer = null;
        try {
            trainer = trainerDAO.findById(trainerId);
            System.out.println("✅ Trainer loaded from database: " + (trainer != null ? trainer.getName() : "null"));
        } catch (Exception e) {
            System.out.println("⚠️ Could not load trainer from DB: " + e.getMessage());
        }
        
        // 4. If database fails, create mock trainer from session data
        if (trainer == null) {
            System.out.println("⚠️ Using mock trainer data for demonstration");
            trainer = new Trainer();
            trainer.setId(trainerId);
            trainer.setName((String) session.getAttribute("username"));
            trainer.setEmail("trainer@healthhub.utm.my");
            trainer.setPhone("012-9999999");
            trainer.setSpecialization("Fitness & Strength Training");
            trainer.setCertification("Certified Personal Trainer (CPT)");
            trainer.setYearsOfExperience(5);
            trainer.setBio("Experienced fitness trainer specializing in strength and conditioning programs.");
            trainer.setUsername("trainer1");
            trainer.setIsActive(true);
        }
        
        model.addAttribute("trainer", trainer);
        
        // 5. Try to get workout plan count
        long planCount = 0;
        try {
            planCount = workoutPlanDAO.countByTrainer(trainerId);
            System.out.println("✅ Plan count: " + planCount);
        } catch (Exception e) {
            System.out.println("⚠️ Could not count plans from DB: " + e.getMessage());
            planCount = 0;
        }
        
        model.addAttribute("planCount", planCount);

        return "trainer/dashboard";
    }
    
    /**
     * List all workout plans created by this trainer
     */
    @GetMapping("/plans")
public String listPlans(Model model, HttpSession session) {
    System.out.println("=== TRAINER PLANS ACCESS ===");
    
    if (!"trainer".equals(session.getAttribute("userrole"))) {
        System.out.println("❌ Not authenticated as trainer");
        return "redirect:/login";
    }
    
    Long trainerId = (Long) session.getAttribute("trainerId");
    System.out.println("Trainer ID from session: " + trainerId);
    
    if (trainerId == null) {
        System.err.println("❌ Trainer ID is null!");
        session.invalidate();
        return "redirect:/login";
    }
    
    try {
        List<WorkoutPlan> plans = workoutPlanDAO.findByTrainer(trainerId);
        System.out.println("✅ Found " + plans.size() + " workout plans");
        
        // Force initialization of lazy-loaded fields
        for (WorkoutPlan plan : plans) {
            if (plan.getMember() != null) {
                org.hibernate.Hibernate.initialize(plan.getMember());
            }
            if (plan.getTrainer() != null) {
                org.hibernate.Hibernate.initialize(plan.getTrainer());
            }
        }
        
        model.addAttribute("plans", plans);
    } catch (Exception e) {
        System.err.println("❌ Error loading plans: " + e.getMessage());
        e.printStackTrace();
        model.addAttribute("plans", List.of());
    }
    
    return "trainer/plan-list";
}

    /**
     * View details of a specific workout plan
     */
    @GetMapping("/plans/view/{id}")
    public String viewPlan(@PathVariable("id") Long id, Model model, HttpSession session) {
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }
        
        try {
            WorkoutPlan plan = workoutPlanDAO.findById(id);
            
            if (plan == null) {
                System.out.println("⚠️ Plan not found with ID: " + id);
                return "redirect:/trainer/plans";
            }
            
            model.addAttribute("plan", plan);
            return "trainer/plan-view";
        } catch (Exception e) {
            System.err.println("❌ Error loading plan: " + e.getMessage());
            return "redirect:/trainer/plans";
        }
    }

    /**
     * Show form to create a new workout plan
     */
    @GetMapping("/plans/new")
    public String showCreatePlanForm(Model model, HttpSession session) {
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }
        
        WorkoutPlan plan = new WorkoutPlan();
        
        try {
            List<Member> members = memberDAO.findAll();
            model.addAttribute("members", members);
        } catch (Exception e) {
            System.out.println("⚠️ Could not load members from DB: " + e.getMessage());
            model.addAttribute("members", List.of()); // Empty list
        }
        
        model.addAttribute("workoutPlan", plan);
        return "trainer/plan-create"; 
    }

    /**
     * Show form to edit an existing workout plan
     */
    @GetMapping("/plans/edit/{id}")
    public String showEditPlanForm(@PathVariable("id") Long id, Model model, HttpSession session) {
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }

        try {
            WorkoutPlan plan = workoutPlanDAO.findById(id);
            
            if (plan == null) {
                return "redirect:/trainer/plans";
            }
            
            List<Member> members = memberDAO.findAll();
            
            model.addAttribute("workoutPlan", plan);
            model.addAttribute("members", members);
            
            return "trainer/plan-create";
        } catch (Exception e) {
            System.err.println("❌ Error loading plan for edit: " + e.getMessage());
            return "redirect:/trainer/plans";
        }
    }

    /**
     * Handle form submission to update an existing workout plan
     */
    @PostMapping("/plans/update")
    public String updateWorkoutPlan(
        @Valid @ModelAttribute("workoutPlan") WorkoutPlan workoutPlan,
        BindingResult result,
        @RequestParam("personId") long personId,
        Model model,
        HttpSession session,
        RedirectAttributes redirectAttributes
    ) {
        // 1. Security Check
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }

        // 2. Validation Errors
        if (result.hasErrors()) {
            System.out.println("⚠️ Validation errors found during update");
            try {
                List<Member> members = memberDAO.findAll();
                model.addAttribute("members", members);
            } catch (Exception e) {
                model.addAttribute("members", List.of());
            }
            return "trainer/plan-create"; 
        }

        try {
            // 3. Re-attach the Person (Member)
            Member assignedMember = memberDAO.findById(personId);
            if (assignedMember == null) {
                redirectAttributes.addFlashAttribute("errorMessage", "Selected member not found.");
                return "redirect:/trainer/plans";
            }
            workoutPlan.setMember(assignedMember);

            // 4. Re-attach the Trainer
            Long trainerId = (Long) session.getAttribute("trainerId");
            if (trainerId == null) {
                return "redirect:/login";
            }
            
            Trainer currentTrainer = trainerDAO.findById(trainerId);
            if (currentTrainer == null) {
                System.err.println("❌ Trainer not found in database!");
                return "redirect:/login";
            }
            workoutPlan.setTrainer(currentTrainer);

            // 5. Update Database
            workoutPlanDAO.update(workoutPlan); 

            redirectAttributes.addFlashAttribute("successMessage", "Workout Plan updated successfully!");
            System.out.println("✅ Workout plan updated: " + workoutPlan.getName());
            
        } catch (Exception e) {
            System.err.println("❌ Error updating workout plan: " + e.getMessage());
            e.printStackTrace();
            redirectAttributes.addFlashAttribute("errorMessage", "Failed to update workout plan.");
        }
        
        return "redirect:/trainer/plans";
    }

    /**
     * Handle workout plan deletion
     */
    @PostMapping("/plans/delete")
    public String deleteWorkoutPlan(@RequestParam("id") Long id, 
                                   HttpSession session, 
                                   RedirectAttributes redirectAttributes) {
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }

        try {
            workoutPlanDAO.delete(id);
            redirectAttributes.addFlashAttribute("successMessage", "Workout Plan deleted successfully.");
            System.out.println("✅ Workout plan deleted with ID: " + id);
        } catch (Exception e) {
            System.err.println("❌ Error deleting workout plan: " + e.getMessage());
            redirectAttributes.addFlashAttribute("errorMessage", "Failed to delete workout plan.");
        }
        
        return "redirect:/trainer/plans";
    }

    /**
     * Handle form submission to save a new workout plan
     */
    @PostMapping("/plans/save")
    public String saveWorkoutPlan(
        @Valid @ModelAttribute("workoutPlan") WorkoutPlan workoutPlan,
        BindingResult result,
        @RequestParam("personId") long personId,
        Model model,
        HttpSession session,
        RedirectAttributes redirectAttributes
    ) {
        if (!"trainer".equals(session.getAttribute("userrole"))) {
            return "redirect:/login";
        }

        // 1. Handle Validation Errors
        if (result.hasErrors()) {
            System.out.println("--------------------------------------------------");
            System.out.println("❌ VALIDATION FAILED! HERE IS THE REASON:");
            result.getAllErrors().forEach(error -> System.out.println(error.toString()));
            System.out.println("--------------------------------------------------");
            
            try {
                List<Member> members = memberDAO.findAll();
                model.addAttribute("members", members);
            } catch (Exception e) {
                model.addAttribute("members", List.of());
            }
            return "trainer/plan-create";
        }

        try {
            // 2. Attach the Person (Member)
            Member assignedMember = memberDAO.findById(personId);
            if (assignedMember == null) {
                redirectAttributes.addFlashAttribute("errorMessage", "Selected member not found.");
                return "redirect:/trainer/plans";
            }
            workoutPlan.setMember(assignedMember);
            
            // 3. Set Trainer from Session
            Long trainerId = (Long) session.getAttribute("trainerId");
            
            if (trainerId == null) {
                System.err.println("❌ ERROR: Trainer ID is null in session during save!");
                return "redirect:/login";
            }
            
            Trainer currentTrainer = trainerDAO.findById(trainerId);
            
            if (currentTrainer == null) {
                System.err.println("❌ ERROR: Could not find trainer with ID: " + trainerId);
                return "redirect:/login";
            }
            
            workoutPlan.setTrainer(currentTrainer); 
            
            // 4. Save to Database
            workoutPlanDAO.save(workoutPlan);
            
            redirectAttributes.addFlashAttribute("successMessage", 
                "Workout Plan '" + workoutPlan.getName() + "' created successfully.");
            
            System.out.println("✅ Workout plan created: " + workoutPlan.getName());
            
        } catch (Exception e) {
            System.err.println("❌ Error saving workout plan: " + e.getMessage());
            e.printStackTrace();
            redirectAttributes.addFlashAttribute("errorMessage", "Failed to create workout plan.");
        }
        
        return "redirect:/trainer/plans";
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\AdminDAO.java
Size: 246 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Admin;

public interface AdminDAO extends GenericDAO<Admin> {
    Admin findByUsername(String username);
    Admin authenticate(String username, String password);
}



================================================================================
File: main\java\com\example\healthhub\dao\AdminDAOHibernate.java
Size: 2.04 kB
================================================================================

// ===== HIBERNATE IMPLEMENTATION =====
package com.example.healthhub.dao;

import com.example.healthhub.model.Admin;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class AdminDAOHibernate implements AdminDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(Admin admin) {
        getSession().save(admin);
    }

    @Override
    public void update(Admin admin) {
        getSession().update(admin);
    }

    @Override
    public void delete(Long id) {
        Admin admin = findById(id);
        if (admin != null) {
            getSession().delete(admin);
        }
    }

    @Override
    public Admin findById(Long id) {
        return getSession().get(Admin.class, id);
    }

    @Override
    public List<Admin> findAll() {
        Query<Admin> query = getSession().createQuery("FROM Admin", Admin.class);
        return query.getResultList();
    }

    @Override
    public Admin findByUsername(String username) {
        Query<Admin> query = getSession()
            .createQuery("FROM Admin WHERE username = :username", Admin.class);
        query.setParameter("username", username);
        return query.uniqueResult();
    }

    @Override
    public Admin authenticate(String username, String password) {
        Query<Admin> query = getSession()
            .createQuery("FROM Admin WHERE username = :username AND password = :password", 
                        Admin.class);
        query.setParameter("username", username);
        query.setParameter("password", password);
        return query.uniqueResult();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\BmiRecordDAO.java
Size: 297 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.BmiRecord;
import java.util.List;

// ===== INTERFACE =====
public interface BmiRecordDAO extends GenericDAO<BmiRecord> {
    List<BmiRecord> findByMember(Long memberId);
    List<BmiRecord> findRecent(int limit);
}


================================================================================
File: main\java\com\example\healthhub\dao\BmiRecordDAOHibernate.java
Size: 2.06 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.BmiRecord;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class BmiRecordDAOHibernate implements BmiRecordDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(BmiRecord record) {
        getSession().save(record);
    }

    @Override
    public void update(BmiRecord record) {
        getSession().update(record);
    }

    @Override
    public void delete(Long id) {
        BmiRecord record = findById(id);
        if (record != null) {
            getSession().delete(record);
        }
    }

    @Override
    public BmiRecord findById(Long id) {
        return getSession().get(BmiRecord.class, id);
    }

    @Override
    public List<BmiRecord> findAll() {
        Query<BmiRecord> query = getSession().createQuery("FROM BmiRecord", BmiRecord.class);
        return query.getResultList();
    }

    @Override
    public List<BmiRecord> findByMember(Long memberId) {
        // ✅ ALIAS ADDED: 'b'
        Query<BmiRecord> query = getSession()
            .createQuery("FROM BmiRecord b WHERE b.member.id = :memberId ORDER BY b.recordedAt DESC", BmiRecord.class);
        query.setParameter("memberId", memberId);
        return query.getResultList();
    }

    @Override
    public List<BmiRecord> findRecent(int limit) {
        // ✅ ALIAS ADDED: 'b'
        Query<BmiRecord> query = getSession()
            .createQuery("FROM BmiRecord b ORDER BY b.recordedAt DESC", BmiRecord.class);
        query.setMaxResults(limit);
        return query.getResultList();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\CategoryDAO.java
Size: 187 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Category;

public interface CategoryDAO extends GenericDAO<Category> {
    Category findByName(String name);
}

================================================================================
File: main\java\com\example\healthhub\dao\CategoryDaoHibernate.java
Size: 1.64 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Category;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class CategoryDaoHibernate implements CategoryDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(Category category) {
        getSession().save(category);
    }

    @Override
    public void update(Category category) {
        getSession().update(category);
    }

    @Override
    public void delete(Long id) {
        Category category = findById(id);
        if (category != null) {
            getSession().delete(category);
        }
    }

    @Override
    public Category findById(Long id) {
        return getSession().get(Category.class, id);
    }

    @Override
    public List<Category> findAll() {
        Query<Category> query = getSession().createQuery("FROM Category", Category.class);
        return query.getResultList();
    }

    @Override
    public Category findByName(String name) {
        Query<Category> query = getSession()
            .createQuery("FROM Category WHERE name = :name", Category.class);
        query.setParameter("name", name);
        return query.uniqueResult();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\EnrollmentDAO.java
Size: 424 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Enrollment;
import java.util.List;

public interface EnrollmentDAO extends GenericDAO<Enrollment> {
    List<Enrollment> findByProgram(Long programId);
    List<Enrollment> findActiveEnrollments();
    Long countAllEnrollments();
    List<Object[]> findTopEnrolledPrograms(int limit);
    
    List<Enrollment> findByMember(Long memberId);
}

================================================================================
File: main\java\com\example\healthhub\dao\EnrollmentDaoHibernate.java
Size: 3.24 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Enrollment;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class EnrollmentDaoHibernate implements EnrollmentDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(Enrollment enrollment) {
        getSession().save(enrollment);
    }

    @Override
    public void update(Enrollment enrollment) {
        getSession().update(enrollment);
    }

    @Override
    public void delete(Long id) {
        Enrollment enrollment = findById(id);
        if (enrollment != null) {
            getSession().delete(enrollment);
        }
    }

    @Override
    public Enrollment findById(Long id) {
        return getSession().get(Enrollment.class, id);
    }

    @Override
    public List<Enrollment> findAll() {
        Query<Enrollment> query = getSession().createQuery("FROM Enrollment", Enrollment.class);
        return query.getResultList();
    }


    @Override
    public List<Enrollment> findByProgram(Long programId) {
        // ✅ ALIAS ADDED: 'e'
        Query<Enrollment> query = getSession()
            .createQuery("FROM Enrollment e WHERE e.program.id = :programId", Enrollment.class);
        query.setParameter("programId", programId);
        return query.getResultList();
    }

    @Override
    public List<Enrollment> findActiveEnrollments() {
        // ✅ ALIAS ADDED: 'e'
        Query<Enrollment> query = getSession()
            .createQuery("FROM Enrollment e WHERE e.status = 'Active'", Enrollment.class);
        return query.getResultList();
    }

     @Override
    public Long countAllEnrollments() {
        // HQL query to count the total number of Enrollment records
        Query<Long> query = getSession().createQuery("SELECT COUNT(e.id) FROM Enrollment e", Long.class);
        return query.uniqueResult();
    }

    @Override
    public List<Object[]> findTopEnrolledPrograms(int limit) {
        // HQL uses GROUP BY and ORDER BY to aggregate enrollment counts per program.
        String hql = "SELECT e.program, COUNT(e.id) AS enrollmentCount " +
                     "FROM Enrollment e " +
                     "GROUP BY e.program " +
                     "ORDER BY enrollmentCount DESC";

        Query<Object[]> query = getSession().createQuery(hql, Object[].class);
        query.setMaxResults(limit); 
        return query.getResultList();
    }

    @Override
    public List<Enrollment> findByMember(Long memberId) {
        // ✅ ALIAS ADDED: 'e'
        Query<Enrollment> query = getSession()
            .createQuery("FROM Enrollment e WHERE e.member.id = :memberId", Enrollment.class);
        query.setParameter("memberId", memberId);
        return query.getResultList();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\GenericDAO.java
Size: 230 B
================================================================================

package com.example.healthhub.dao;

import java.util.List;

public interface GenericDAO<T> {
    void save(T entity);
    void update(T entity);
    void delete(Long id);
    T findById(Long id);
    List<T> findAll();
}

================================================================================
File: main\java\com\example\healthhub\dao\MemberDAO
Size: 0 B
================================================================================



================================================================================
File: main\java\com\example\healthhub\dao\MemberDAO.java
Size: 371 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Member;
import java.util.List;

public interface MemberDAO extends GenericDAO<Member> {
    Member findByUsername(String username);
    Member authenticate(String username, String password);
    List<Member> findByMemberType(String memberType);
    List<Member> searchByName(String name);
}

================================================================================
File: main\java\com\example\healthhub\dao\MemberDaoHibernate.java
Size: 3.47 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Member;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class MemberDaoHibernate implements MemberDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(Member member) {
        getSession().save(member);
    }

    @Override
    public void update(Member member) {
        getSession().update(member);
    }

    @Override
    public void delete(Long id) {
        Member member = findById(id);
        if (member != null) {
            getSession().delete(member);
        }
    }

    @Override
public Member findById(Long id) {
    try {
        Member member = getSession().get(Member.class, id);
        
        if (member != null) {
            // ✅ Force initialization of lazy-loaded collections
            org.hibernate.Hibernate.initialize(member.getBmiHistory());
            
            // ✅ SORT BMI HISTORY BY DATE DESCENDING (NEWEST FIRST)
            if (member.getBmiHistory() != null && !member.getBmiHistory().isEmpty()) {
                member.getBmiHistory().sort((b1, b2) -> 
                    b2.getRecordedAt().compareTo(b1.getRecordedAt())
                );
            }
        }
        
        return member;
    } catch (Exception e) {
        System.err.println("Error loading member: " + e.getMessage());
        throw e;
    }
}

    @Override
    public List<Member> findAll() {
        Query<Member> query = getSession().createQuery("FROM Member", Member.class);
        return query.getResultList();
    }

    @Override
    public Member findByUsername(String username) {
        // ✅ ALIAS ADDED: 'm'
        Query<Member> query = getSession()
            .createQuery("FROM Member m WHERE m.username = :username", Member.class);
        query.setParameter("username", username);
        return query.uniqueResult();
    }

    @Override
    public Member authenticate(String username, String password) {
        // ✅ ALIAS ADDED: 'm'
        Query<Member> query = getSession()
            .createQuery("FROM Member m WHERE m.username = :username AND m.password = :password", Member.class);
        query.setParameter("username", username);
        query.setParameter("password", password);
        return query.uniqueResult();
    }

    @Override
    public List<Member> findByMemberType(String memberType) {
        // ✅ ALIAS ADDED: 'm'
        Query<Member> query = getSession()
            .createQuery("FROM Member m WHERE m.memberType = :type", Member.class);
        query.setParameter("type", memberType);
        return query.getResultList();
    }

    @Override
    public List<Member> searchByName(String name) {
        // ✅ ALIAS ADDED: 'm'
        Query<Member> query = getSession()
            .createQuery("FROM Member m WHERE LOWER(m.name) LIKE :name", Member.class);
        query.setParameter("name", "%" + name.toLowerCase() + "%");
        return query.getResultList();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\ProgramDAO.java
Size: 308 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Program;
import java.util.List;

public interface ProgramDAO extends GenericDAO<Program> {
    List<Program> findActivePrograms();
    List<Program> findByCategory(Long categoryId);
    List<Program> searchByName(String name);
}

================================================================================
File: main\java\com\example\healthhub\dao\ProgramDaoHibernate.java
Size: 2.21 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Program;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class ProgramDaoHibernate implements ProgramDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(Program program) {
        getSession().save(program);
    }

    @Override
    public void update(Program program) {
        getSession().update(program);
    }

    @Override
    public void delete(Long id) {
        Program program = findById(id);
        if (program != null) {
            getSession().delete(program);
        }
    }

    @Override
    public Program findById(Long id) {
        return getSession().get(Program.class, id);
    }

    @Override
    public List<Program> findAll() {
        Query<Program> query = getSession().createQuery("FROM Program", Program.class);
        return query.getResultList();
    }

    @Override
    public List<Program> findActivePrograms() {
        Query<Program> query = getSession()
            .createQuery("FROM Program WHERE isActive = true", Program.class);
        return query.getResultList();
    }

    @Override
    public List<Program> findByCategory(Long categoryId) {
        Query<Program> query = getSession()
            .createQuery("FROM Program WHERE category.id = :categoryId", Program.class);
        query.setParameter("categoryId", categoryId);
        return query.getResultList();
    }

    @Override
    public List<Program> searchByName(String name) {
        Query<Program> query = getSession()
            .createQuery("FROM Program WHERE LOWER(name) LIKE :name", Program.class);
        query.setParameter("name", "%" + name.toLowerCase() + "%");
        return query.getResultList();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\TrainerDAO.java
Size: 317 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Trainer;
import java.util.List;

public interface TrainerDAO extends GenericDAO<Trainer> {
    Trainer findByUsername(String username);
    List<Trainer> findActiveTrainers();
    Trainer authenticate(String username, String password);
}

================================================================================
File: main\java\com\example\healthhub\dao\TrainerDaoHibernate.java
Size: 2.29 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.Trainer;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class TrainerDaoHibernate implements TrainerDAO {

    @Autowired
    private SessionFactory sessionFactory;

    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(Trainer trainer) {
        getSession().save(trainer);
    }

    @Override
    public void update(Trainer trainer) {
        getSession().update(trainer);
    }

    @Override
    public void delete(Long id) {
        Trainer trainer = findById(id);
        if (trainer != null) {
            getSession().delete(trainer);
        }
    }

    @Override
    public Trainer findById(Long id) {
        return getSession().get(Trainer.class, id);
    }

    @Override
    public List<Trainer> findAll() {
        Query<Trainer> query = getSession().createQuery("FROM Trainer", Trainer.class);
        return query.getResultList();
    }

    @Override
    public Trainer findByUsername(String username) {
        Query<Trainer> query = getSession()
            .createQuery("FROM Trainer WHERE username = :username", Trainer.class);
        query.setParameter("username", username);
        return query.uniqueResult();
    }

    @Override
    public List<Trainer> findActiveTrainers() {
        Query<Trainer> query = getSession()
            .createQuery("FROM Trainer WHERE isActive = true", Trainer.class);
        return query.getResultList();
    }

    @Override
    public Trainer authenticate(String username, String password) {
        Query<Trainer> query = getSession()
            .createQuery("FROM Trainer WHERE username = :username AND password = :password", 
                        Trainer.class);
        query.setParameter("username", username);
        query.setParameter("password", password);
        return query.uniqueResult();
    }
}

================================================================================
File: main\java\com\example\healthhub\dao\WorkoutPlanDAO.java
Size: 509 B
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.WorkoutPlan;
import java.util.List;

public interface WorkoutPlanDAO extends GenericDAO<WorkoutPlan> {
    List<WorkoutPlan> findByTrainer(Long trainerId);
    List<WorkoutPlan> findActivePlans();
    List<WorkoutPlan> getPlansByTrainer(Long trainerId);
    WorkoutPlan createNewPlan(WorkoutPlan plan);
    long countByTrainer(Long trainerId);
    
    // ADD THIS METHOD
    List<WorkoutPlan> findByMember(Long memberId);
}

================================================================================
File: main\java\com\example\healthhub\dao\WorkoutPlanDaoHibernate.java
Size: 3 kB
================================================================================

package com.example.healthhub.dao;

import com.example.healthhub.model.WorkoutPlan;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.query.Query;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Repository
@Transactional
public class WorkoutPlanDaoHibernate implements WorkoutPlanDAO {

    @Autowired
    private SessionFactory sessionFactory;
    
    private Session getSession() {
        return sessionFactory.getCurrentSession();
    }

    @Override
    public void save(WorkoutPlan plan) {
        getSession().save(plan);
    }

    @Override
    public void update(WorkoutPlan plan) {
        getSession().update(plan);
    }

    @Override
    public void delete(Long id) {
        WorkoutPlan plan = findById(id);
        if (plan != null) {
            getSession().delete(plan);
        }
    }

    @Override
    public WorkoutPlan findById(Long id) {
        return getSession().get(WorkoutPlan.class, id);
    }

    @Override
    public List<WorkoutPlan> findAll() {
        Query<WorkoutPlan> query = getSession().createQuery("FROM WorkoutPlan", WorkoutPlan.class);
        return query.getResultList();
    }


    @Override
    public List<WorkoutPlan> findByTrainer(Long trainerId) {
        // ✅ ALIAS ADDED: 'w'
        Query<WorkoutPlan> query = getSession()
            .createQuery("FROM WorkoutPlan w WHERE w.trainer.id = :trainerId", WorkoutPlan.class);
        query.setParameter("trainerId", trainerId);
        return query.getResultList();
    }

    @Override
    public List<WorkoutPlan> findActivePlans() {
        // ✅ ALIAS ADDED: 'w'
        Query<WorkoutPlan> query = getSession()
            .createQuery("FROM WorkoutPlan w WHERE w.isActive = true", WorkoutPlan.class);
        return query.getResultList();
    }

    @Override
    public List<WorkoutPlan> getPlansByTrainer(Long trainerId) {
        return findByTrainer(trainerId);
    }

    @Override
    @Transactional
    public WorkoutPlan createNewPlan(WorkoutPlan plan) {
        save(plan); 
        return plan; 
    }

    @Override
    public long countByTrainer(Long trainerId) {
        String hql = "SELECT COUNT(w) FROM WorkoutPlan w WHERE w.trainer.id = :tid";
        return (Long) sessionFactory.getCurrentSession()
                .createQuery(hql)
                .setParameter("tid", trainerId)
                .uniqueResult();
    }

    @Override
    public List<WorkoutPlan> findByMember(Long memberId) {
        // ✅ ALIAS ADDED: 'w'
        Query<WorkoutPlan> query = getSession()
            .createQuery("FROM WorkoutPlan w WHERE w.member.id = :memberId", WorkoutPlan.class);
        query.setParameter("memberId", memberId);
        return query.getResultList();
    }
    
}

================================================================================
File: main\java\com\example\healthhub\model\Admin.java
Size: 1.98 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.*;

@Entity
@Table(name = "admin")
public class Admin {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Name is required.")
    @Column(nullable = false)
    private String name;

    @NotEmpty(message = "Username is required.")
    @Column(unique = true, nullable = false)
    private String username;

    @NotEmpty(message = "Password is required.")
    @Column(nullable = false)
    private String password;

    @Email(message = "Invalid email format.")
    @Column(nullable = false, unique = true)
    private String email;

    @Column(name = "phone")
    private String phone;

    @Column(name = "is_active")
    private Boolean isActive = true;

    // Constructors
    public Admin() {}

    public Admin(String name, String username, String password, String email) {
        this.name = name;
        this.username = username;
        this.password = password;
        this.email = email;
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }

    public String getName() { return name; }
    public void setName(String name) { this.name = name; }

    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }

    public String getPassword() { return password; }
    public void setPassword(String password) { this.password = password; }

    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }

    public String getPhone() { return phone; }
    public void setPhone(String phone) { this.phone = phone; }

    public Boolean getIsActive() { return isActive; }
    public void setIsActive(Boolean isActive) { this.isActive = isActive; }
}

================================================================================
File: main\java\com\example\healthhub\model\BmiRecord.java
Size: 4.47 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.*;
import java.time.LocalDate;
import java.time.LocalDateTime;

/**
 * BmiRecord - Represents a single BMI calculation
 * This is what gets created when someone fills the BMI form
 * It can be linked to a Member (if logged in) or standalone (guest)
 */
@Entity
@Table(name = "bmi_record")
public class BmiRecord {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Name is required.")
    @Column(nullable = false)
    private String name;

    @NotNull(message = "Year of Birth is required.")
    @Min(value = 1900, message = "Please enter a valid Year of Birth.")
    @Max(value = 2025, message = "Please enter a valid Year of Birth.")
    @Column(name = "year_of_birth", nullable = false)
    private Integer yearOfBirth;

    @NotNull(message = "Weight is required.")
    @DecimalMin(value = "0.1", inclusive = false, message = "Weight must be positive.")
    @Column(nullable = false)
    private Double weight;

    @NotNull(message = "Height is required.")
    @DecimalMin(value = "0.1", inclusive = false, message = "Height must be positive.")
    @Column(nullable = false)
    private Double height;

    @NotEmpty(message = "Gender is required.")
    @Column(nullable = false)
    private String gender;
    
    @Column(name = "interests")
    private String interests; // comma-separated values

    @Column(name = "recorded_at", nullable = false)
    private LocalDateTime recordedAt;

    // Link to Member (optional - null if guest calculation)
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "member_id")
    private Member member;

    // Constructors
    public BmiRecord() {
        this.recordedAt = LocalDateTime.now();
    }

    public BmiRecord(String name, int yearOfBirth, double weight, double height, String gender) {
        this();
        this.name = name;
        this.yearOfBirth = yearOfBirth;
        this.weight = weight;
        this.height = height;
        this.gender = gender;
    }

    // Calculated methods
    public int getAge() {
        return LocalDate.now().getYear() - this.yearOfBirth;
    }

    public double getBmi() {
        if (this.height <= 0) {
            return 0;
        }
        return this.weight / (this.height * this.height);
    }

    public String getCategory() {
        double bmi = getBmi();
        if (bmi < 18.5) {
            return "Underweight";
        } else if (bmi < 25) {
            return "Normal weight";
        } else if (bmi < 30) {
            return "Overweight";
        } else {
            return "Obese";
        }
    }

    // Helper methods for interests array conversion
    public String[] getInterestsArray() {
        if (interests == null || interests.isEmpty()) {
            return new String[0];
        }
        return interests.split(",");
    }

    public void setInterestsArray(String[] interestsArray) {
        if (interestsArray == null || interestsArray.length == 0) {
            this.interests = "";
        } else {
            this.interests = String.join(",", interestsArray);
        }
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }

    public String getName() { return name; }
    public void setName(String name) { this.name = name; }

    public Integer getYearOfBirth() { return yearOfBirth; }
    public void setYearOfBirth(Integer yearOfBirth) { this.yearOfBirth = yearOfBirth; }

    public Double getWeight() { return weight; }
    public void setWeight(Double weight) { this.weight = weight; }

    public Double getHeight() { return height; }
    public void setHeight(Double height) { this.height = height; }

    public String getGender() { return gender; }
    public void setGender(String gender) { this.gender = gender; }

    public String getInterests() { return interests; }
    public void setInterests(String interests) { this.interests = interests; }

    public LocalDateTime getRecordedAt() { return recordedAt; }
    public void setRecordedAt(LocalDateTime recordedAt) { this.recordedAt = recordedAt; }

    public Member getMember() { return member; }
    public void setMember(Member member) { this.member = member; }
}

================================================================================
File: main\java\com\example\healthhub\model\Category.java
Size: 1.38 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.NotEmpty;
import java.util.ArrayList;
import java.util.List;

@Entity
@Table(name = "category")
public class Category {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Category name is required.")
    @Column(nullable = false, unique = true)
    private String name;

    @Column(columnDefinition = "TEXT")
    private String description;

    @OneToMany(mappedBy = "category", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<Program> programs = new ArrayList<>();

    public Category() {}

    public Category(String name, String description) {
        this.name = name;
        this.description = description;
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getDescription() { return description; }
    public void setDescription(String description) { this.description = description; }
    
    public List<Program> getPrograms() { return programs; }
    public void setPrograms(List<Program> programs) { this.programs = programs; }
}

================================================================================
File: main\java\com\example\healthhub\model\Enrollment.java
Size: 2.8 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import java.time.LocalDate;

@Entity
@Table(name = "enrollment")
public class Enrollment {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "member_id", nullable = false)
    private Member member; // CHANGED from Person to Member

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "program_id", nullable = false)
    private Program program;

    @Column(name = "enrollment_date", nullable = false)
    private LocalDate enrollmentDate;

    @Column(name = "start_date")
    private LocalDate startDate;

    @Column(name = "end_date")
    private LocalDate endDate;

    @Column(name = "status")
    private String status;

    @Column(name = "payment_status")
    private String paymentStatus;

    @Column(name = "amount_paid")
    private Double amountPaid;

    @Column(columnDefinition = "TEXT")
    private String notes;

    public Enrollment() {
        this.enrollmentDate = LocalDate.now();
        this.status = "Active";
        this.paymentStatus = "Pending";
    }

    public Enrollment(Member member, Program program) {
        this();
        this.member = member;
        this.program = program;
        this.amountPaid = program.getPrice();
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public Member getMember() { return member; }
    public void setMember(Member member) { this.member = member; }
    
    public Program getProgram() { return program; }
    public void setProgram(Program program) { this.program = program; }
    
    public LocalDate getEnrollmentDate() { return enrollmentDate; }
    public void setEnrollmentDate(LocalDate enrollmentDate) { this.enrollmentDate = enrollmentDate; }
    
    public LocalDate getStartDate() { return startDate; }
    public void setStartDate(LocalDate startDate) { this.startDate = startDate; }
    
    public LocalDate getEndDate() { return endDate; }
    public void setEndDate(LocalDate endDate) { this.endDate = endDate; }
    
    public String getStatus() { return status; }
    public void setStatus(String status) { this.status = status; }
    
    public String getPaymentStatus() { return paymentStatus; }
    public void setPaymentStatus(String paymentStatus) { this.paymentStatus = paymentStatus; }
    
    public Double getAmountPaid() { return amountPaid; }
    public void setAmountPaid(Double amountPaid) { this.amountPaid = amountPaid; }
    
    public String getNotes() { return notes; }
    public void setNotes(String notes) { this.notes = notes; }
}

================================================================================
File: main\java\com\example\healthhub\model\Member.java
Size: 5.21 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.*;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;
import java.util.Arrays;



@Entity
@Table(name = "member")
public class Member {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Name is required.")
    @Column(nullable = false)
    private String name;

    @NotEmpty(message = "Username is required.")
    @Column(unique = true, nullable = false)
    private String username;

    @NotEmpty(message = "Password is required.")
    @Column(nullable = false)
    private String password;

    @Email(message = "Invalid email format.")
    @Column(nullable = false, unique = true)
    private String email;

    @Column(name = "phone")
    private String phone;

    @Column(name = "member_type") // "student" or "staff"
    private String memberType;

    @NotNull(message = "Year of Birth is required.")
    @Min(value = 1900)
    @Max(value = 2025)
    @Column(name = "year_of_birth")
    private Integer yearOfBirth;

    @NotEmpty(message = "Gender is required.")
    @Column(nullable = false)
    private String gender;

    // Relationships
    @OneToMany(mappedBy = "member", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<Enrollment> enrollments = new ArrayList<>();

    @OneToMany(mappedBy = "member", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<WorkoutPlan> workoutPlans = new ArrayList<>();

    // BMI History - tracks all BMI records created by this member
    @OneToMany(mappedBy = "member", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    @OrderBy("recordedAt DESC")
    private List<BmiRecord> bmiHistory = new ArrayList<>();

    @Column(name = "is_active")
    private Boolean isActive = true;

    // Constructors
    public Member() {}

    public Member(String name, String username, String password, String email) {
        this.name = name;
        this.username = username;
        this.password = password;
        this.email = email;
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }

    public String getName() { return name; }
    public void setName(String name) { this.name = name; }

    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }

    public String getPassword() { return password; }
    public void setPassword(String password) { this.password = password; }

    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }

    public String getPhone() { return phone; }
    public void setPhone(String phone) { this.phone = phone; }

    public String getMemberType() { return memberType; }
    public void setMemberType(String memberType) { this.memberType = memberType; }

    public Integer getYearOfBirth() { return yearOfBirth; }
    public void setYearOfBirth(Integer yearOfBirth) { this.yearOfBirth = yearOfBirth; }

    public String getGender() { return gender; }
    public void setGender(String gender) { this.gender = gender; }

    public List<Enrollment> getEnrollments() { return enrollments; }
    public void setEnrollments(List<Enrollment> enrollments) { this.enrollments = enrollments; }

    public List<WorkoutPlan> getWorkoutPlans() { return workoutPlans; }
    public void setWorkoutPlans(List<WorkoutPlan> workoutPlans) { this.workoutPlans = workoutPlans; }

    public List<BmiRecord> getBmiHistory() { return bmiHistory; }
    public void setBmiHistory(List<BmiRecord> bmiHistory) { this.bmiHistory = bmiHistory; }

    public Boolean getIsActive() { return isActive; }
    public void setIsActive(Boolean isActive) { this.isActive = isActive; }

    // Add these methods to Member class
public int getAge() {
    if (yearOfBirth == null) return 0;
    return LocalDate.now().getYear() - this.yearOfBirth;
}

public double getBmi() {
    // Get latest BMI from history
    if (bmiHistory != null && !bmiHistory.isEmpty()) {
        // Assuming bmiHistory is ordered by date DESC
        return bmiHistory.get(0).getBmi();
    }
    return 0.0;
}

public String getCategory() {
    double bmi = getBmi();
    if (bmi < 18.5) return "Underweight";
    else if (bmi < 25) return "Normal weight";
    else if (bmi < 30) return "Overweight";
    else return "Obese";
}

public double getWeight() {
    if (bmiHistory != null && !bmiHistory.isEmpty()) {
        return bmiHistory.get(0).getWeight();
    }
    return 0.0;
}

public double getHeight() {
    if (bmiHistory != null && !bmiHistory.isEmpty()) {
        return bmiHistory.get(0).getHeight();
    }
    return 0.0;
}

public List<String> getInterests() {
    if (bmiHistory != null && !bmiHistory.isEmpty()) {
        String[] arr = bmiHistory.get(0).getInterestsArray();
        return arr != null ? Arrays.asList(arr) : new ArrayList<>();
    }
    return new ArrayList<>();
}
}

================================================================================
File: main\java\com\example\healthhub\model\Program.java
Size: 3.39 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.*;
import java.util.ArrayList;
import java.util.List;

@Entity
@Table(name = "program")
public class Program {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Program name is required.")
    @Column(nullable = false)
    private String name;

    @Column(columnDefinition = "TEXT")
    private String description;

    @NotNull(message = "Duration is required.")
    @Min(value = 1, message = "Duration must be at least 1 week.")
    @Column(name = "duration_weeks", nullable = false)
    private Integer durationWeeks;

    @NotNull(message = "Price is required.")
    @DecimalMin(value = "0.0", message = "Price must be positive.")
    @Column(nullable = false)
    private Double price;

    @Column(name = "difficulty_level")
    private String difficultyLevel;

    @Column(name = "max_participants")
    private Integer maxParticipants;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "category_id")
    private Category category;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "trainer_id")
    private Trainer trainer;

    @OneToMany(mappedBy = "program", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<Enrollment> enrollments = new ArrayList<>();

    @Column(name = "is_active")
    private Boolean isActive = true;

    public Program() {}

    public Program(String name, String description, Integer durationWeeks, Double price) {
        this.name = name;
        this.description = description;
        this.durationWeeks = durationWeeks;
        this.price = price;
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getDescription() { return description; }
    public void setDescription(String description) { this.description = description; }
    
    public Integer getDurationWeeks() { return durationWeeks; }
    public void setDurationWeeks(Integer durationWeeks) { this.durationWeeks = durationWeeks; }
    
    public Double getPrice() { return price; }
    public void setPrice(Double price) { this.price = price; }
    
    public String getDifficultyLevel() { return difficultyLevel; }
    public void setDifficultyLevel(String difficultyLevel) { this.difficultyLevel = difficultyLevel; }
    
    public Integer getMaxParticipants() { return maxParticipants; }
    public void setMaxParticipants(Integer maxParticipants) { this.maxParticipants = maxParticipants; }
    
    public Category getCategory() { return category; }
    public void setCategory(Category category) { this.category = category; }
    
    public Trainer getTrainer() { return trainer; }
    public void setTrainer(Trainer trainer) { this.trainer = trainer; }
    
    public List<Enrollment> getEnrollments() { return enrollments; }
    public void setEnrollments(List<Enrollment> enrollments) { this.enrollments = enrollments; }
    
    public Boolean getIsActive() { return isActive; }
    public void setIsActive(Boolean isActive) { this.isActive = isActive; }
}

================================================================================
File: main\java\com\example\healthhub\model\Trainer.java
Size: 3.57 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.*;
import java.util.ArrayList;
import java.util.List;

@Entity
@Table(name = "trainer")
public class Trainer {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Name is required.")
    @Column(nullable = false)
    private String name;

    @NotEmpty(message = "Email is required.")
    @Email(message = "Invalid email format.")
    @Column(nullable = false, unique = true)
    private String email;

    @Column(name = "phone")
    private String phone;

    @Column(name = "specialization")
    private String specialization;

    @Column(name = "certification")
    private String certification;

    @Min(value = 0, message = "Experience must be positive.")
    @Column(name = "years_of_experience")
    private Integer yearsOfExperience;

    @Column(columnDefinition = "TEXT")
    private String bio;

    @Column(unique = true)
    private String username;

    @Column(name = "password")
    private String password;

    @Column(name = "is_active")
    private Boolean isActive = true;

    @OneToMany(mappedBy = "trainer", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<Program> programs = new ArrayList<>();

    @OneToMany(mappedBy = "trainer", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private List<WorkoutPlan> workoutPlans = new ArrayList<>();

    public Trainer() {}

    public Trainer(String name, String email, String specialization) {
        this.name = name;
        this.email = email;
        this.specialization = specialization;
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }
    
    public String getPhone() { return phone; }
    public void setPhone(String phone) { this.phone = phone; }
    
    public String getSpecialization() { return specialization; }
    public void setSpecialization(String specialization) { this.specialization = specialization; }
    
    public String getCertification() { return certification; }
    public void setCertification(String certification) { this.certification = certification; }
    
    public Integer getYearsOfExperience() { return yearsOfExperience; }
    public void setYearsOfExperience(Integer yearsOfExperience) { this.yearsOfExperience = yearsOfExperience; }
    
    public String getBio() { return bio; }
    public void setBio(String bio) { this.bio = bio; }
    
    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }
    
    public String getPassword() { return password; }
    public void setPassword(String password) { this.password = password; }
    
    public Boolean getIsActive() { return isActive; }
    public void setIsActive(Boolean isActive) { this.isActive = isActive; }
    
    public List<Program> getPrograms() { return programs; }
    public void setPrograms(List<Program> programs) { this.programs = programs; }
    
    public List<WorkoutPlan> getWorkoutPlans() { return workoutPlans; }
    public void setWorkoutPlans(List<WorkoutPlan> workoutPlans) { this.workoutPlans = workoutPlans; }
}

================================================================================
File: main\java\com\example\healthhub\model\WorkoutPlan.java
Size: 3.31 kB
================================================================================

package com.example.healthhub.model;

import javax.persistence.*;
import javax.validation.constraints.NotEmpty;

import org.springframework.format.annotation.DateTimeFormat;

import java.time.LocalDate;

@Entity
@Table(name = "workout_plan")
public class WorkoutPlan {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @NotEmpty(message = "Plan name is required.")
    @Column(nullable = false)
    private String name;

    @Column(columnDefinition = "TEXT")
    private String description;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "member_id")
    private Member member; // CHANGED from Person to Member

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "trainer_id")
    private Trainer trainer;

    @DateTimeFormat(pattern = "yyyy-MM-dd")
    @Column(name = "created_date", nullable = false)
    private LocalDate createdDate;

    @DateTimeFormat(pattern = "yyyy-MM-dd")
    @Column(name = "start_date")
    private LocalDate startDate;

    @DateTimeFormat(pattern = "yyyy-MM-dd")
    @Column(name = "end_date")
    private LocalDate endDate;

    @Column(name = "goal")
    private String goal;

    @Column(columnDefinition = "TEXT")
    private String exercises;

    @Column(columnDefinition = "TEXT")
    private String notes;

    @Column(name = "is_active")
    private Boolean isActive = true;

    public WorkoutPlan() {
        this.createdDate = LocalDate.now();
    }

    public WorkoutPlan(String name, Member member, Trainer trainer) {
        this();
        this.name = name;
        this.member = member;
        this.trainer = trainer;
    }

    // Getters and Setters
    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getDescription() { return description; }
    public void setDescription(String description) { this.description = description; }
    
    public Member getMember() { return member; }
    public void setMember(Member member) { this.member = member; }
    
    public Trainer getTrainer() { return trainer; }
    public void setTrainer(Trainer trainer) { this.trainer = trainer; }
    
    public LocalDate getCreatedDate() { return createdDate; }
    public void setCreatedDate(LocalDate createdDate) { this.createdDate = createdDate; }
    
    public LocalDate getStartDate() { return startDate; }
    public void setStartDate(LocalDate startDate) { this.startDate = startDate; }
    
    public LocalDate getEndDate() { return endDate; }
    public void setEndDate(LocalDate endDate) { this.endDate = endDate; }
    
    public String getGoal() { return goal; }
    public void setGoal(String goal) { this.goal = goal; }
    
    public String getExercises() { return exercises; }
    public void setExercises(String exercises) { this.exercises = exercises; }
    
    public String getNotes() { return notes; }
    public void setNotes(String notes) { this.notes = notes; }
    
    public Boolean getIsActive() { return isActive; }
    public void setIsActive(Boolean isActive) { this.isActive = isActive; }
}

================================================================================
File: main\resources\database.properties
Size: 468 B
================================================================================

# MySQL Database Configuration
jdbc.driverClassName=com.mysql.cj.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/healthhubutm?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
jdbc.username=root
jdbc.password=

# Hibernate Configuration
hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
hibernate.show_sql=true
hibernate.format_sql=true
hibernate.hbm2ddl.auto=update
hibernate.connection.pool_size=10
logging.level.org.hibernate.SQL=DEBUG


================================================================================
File: main\webapp\WEB-INF\dispatcher-servlet.xml
Size: 4.27 kB
================================================================================

<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context.xsd
           http://www.springframework.org/schema/mvc
           http://www.springframework.org/schema/mvc/spring-mvc.xsd
           http://www.springframework.org/schema/tx
           http://www.springframework.org/schema/tx/spring-tx.xsd">

    <!-- Enable component scanning -->
    <context:component-scan base-package="com.example.healthhub" />

    <!-- Enable annotation-driven MVC with conversion service -->
    <mvc:annotation-driven>
        <mvc:message-converters>
            <bean class="org.springframework.http.converter.StringHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.FormHttpMessageConverter"/>
        </mvc:message-converters>
    </mvc:annotation-driven>

    <!-- Enable transaction annotations -->
    <tx:annotation-driven transaction-manager="transactionManager" />

    <!-- Load database properties -->
    <context:property-placeholder location="classpath:database.properties" />

    <!-- DataSource Configuration -->
    <bean id="dataSource" class="org.apache.commons.dbcp2.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${jdbc.driverClassName}" />
        <property name="url" value="${jdbc.url}" />
        <property name="username" value="${jdbc.username}" />
        <property name="password" value="${jdbc.password}" />
        <property name="initialSize" value="5" />
        <property name="maxTotal" value="10" />
    </bean>

    <!-- Hibernate SessionFactory -->
    <bean id="sessionFactory" class="org.springframework.orm.hibernate5.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="packagesToScan" value="com.example.healthhub.model" />
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
                <prop key="hibernate.format_sql">${hibernate.format_sql}</prop>
                <prop key="hibernate.hbm2ddl.auto">${hibernate.hbm2ddl.auto}</prop>
                <prop key="hibernate.connection.pool_size">${hibernate.connection.pool_size}</prop>
                <prop key="hibernate.enable_lazy_load_no_trans">true</prop>
            </props>
        </property>
    </bean>

    <!-- Transaction Manager -->
    <bean id="transactionManager" class="org.springframework.orm.hibernate5.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <!-- Thymeleaf Template Resolver -->
    <bean id="templateResolver" class="org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver">
        <property name="prefix" value="/WEB-INF/views/" />
        <property name="suffix" value=".html" />
        <property name="templateMode" value="HTML" />
        <property name="cacheable" value="false" />
        <property name="characterEncoding" value="UTF-8" />
    </bean>

    <!-- Thymeleaf Template Engine -->
    <bean id="templateEngine" class="org.thymeleaf.spring5.SpringTemplateEngine">
        <property name="templateResolver" ref="templateResolver" />
        <property name="enableSpringELCompiler" value="true" />
    </bean>

    <!-- Thymeleaf View Resolver -->
    <bean class="org.thymeleaf.spring5.view.ThymeleafViewResolver">
        <property name="templateEngine" ref="templateEngine" />
        <property name="characterEncoding" value="UTF-8" />
        <property name="order" value="1" />
    </bean>

</beans>

================================================================================
File: main\webapp\WEB-INF\views\admin\category-form.html
Size: 2.56 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>

<!-- Navigation Bar Fragment (Position UNCHANGED) -->
<div th:replace="~{fragments :: main-menu}"></div>

<div class="container mt-4">
    <!-- Dynamic Title: "Add New Category" or "Edit Category" -->
    <h1 th:text="${pageTitle}">Category Form</h1>
    
    <!-- The Form: Uses th:object and maps to the save endpoint in the CategoryController -->
    <form th:action="@{/admin/categories/save}" th:object="${category}" method="post">
        
        <!-- Hidden ID field for distinguishing between SAVE (new) and UPDATE (existing) -->
        <input type="hidden" th:field="*{id}" />
        
        <!-- Name Field -->
        <div class="mb-3">
            <label for="name" class="form-label">Category Name:</label>
            <input type="text" 
                   id="name" 
                   th:field="*{name}" 
                   class="form-control" 
                   placeholder="e.g., Strength Training, Wellness, Yoga"
                   required />
        </div>
        
        <!-- Description Field -->
        <div class="mb-3">
            <label for="description" class="form-label">Description (Optional):</label>
            <textarea id="description" 
                      th:field="*{description}" 
                      class="form-control" 
                      rows="3"
                      placeholder="Briefly describe what programs this category covers."></textarea>
        </div>
        
        <div class="d-flex justify-content-between mt-4">
            <!-- Submit Button (Text dynamically changes based on ID) -->
            <button type="submit" class="btn btn-primary-custom">
                <span th:if="${category.id == null}">Create Category</span>
                <span th:unless="${category.id == null}">Update Category</span>
            </button>
            
            <!-- Back Button -->
            <a th:href="@{/admin/categories/list}" class="btn btn-secondary">
                Cancel / Back to List
            </a>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\category-list.html
Size: 3.14 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>

<!-- Navigation Bar Fragment (Position UNCHANGED) -->
<div th:replace="~{fragments :: main-menu}"></div>

<div class="container mt-4">
    <h1 th:text="${pageTitle}">Manage Program Categories</h1>
    
    <!-- Flash Message -->
    <div th:if="${flashMessage}" class="flash-message">
        <span th:text="${flashMessage}"></span>
    </div>

    <!-- Link to Add New Category -->
    <a th:href="@{/admin/categories/new}" class="btn add-button btn-success mb-4">
        <i class="fas fa-plus-circle"></i> + Add New Category
    </a>
    
    <!-- Table to Display Categories (Using Bootstrap classes for aesthetics) -->
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th style="width: 5%;">ID</th>
                <th style="width: 25%;">Name</th>
                <th style="width: 45%;">Description</th>
                <th style="width: 25%;">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="category : ${categories}">
                <td th:text="${category.id}">1</td>
                <td th:text="${category.name}">Cardio</td>
                <td th:text="${category.description}">Focuses on endurance and heart health.</td>
                <td class="action-links">
                    
                    <!-- 1. VIEW PROGRAMS BUTTON (NEW) -->
                    <!-- This links to a new ProgramController method that will filter programs by category ID -->
                    <a th:href="@{/admin/programs/viewByCategory/{id}(id=${category.id})}" 
                       class="btn btn-info btn-sm">
                        View Programs
                    </a>
                    
                    <!-- 2. EDIT BUTTON -->
                    <a th:href="@{/admin/categories/edit/{id}(id=${category.id})}" 
                       class="btn btn-primary btn-sm">
                        Edit
                    </a>
                    
                    <!-- 3. DELETE BUTTON -->
                    <a th:href="@{/admin/categories/delete/{id}(id=${category.id})}" 
                       onclick="return confirm('WARNING: Are you sure you want to delete this category? This may affect linked programs!');"
                       class="btn btn-danger btn-sm">
                        Delete
                    </a>
                </td>
            </tr>
        </tbody>
    </table>
    
    <p th:if="${categories.isEmpty()}" class="alert alert-warning mt-4">
        No categories found. Click 'Add New Category' to start managing programs.
    </p>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\dashboard.html
Size: 2.03 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>
<body>
<div th:replace="~{fragments :: main-menu}"></div>

    <div class="container mt-4">
        <div class="card">  
            <div class="card-header">
                <span>User Profile</span>
            </div>
            <div class="card-body">
                <h5>Profile Information</h5>
                <hr>
                <p><strong>Username:</strong> <span th:text="${session.username}">User</span></p>
                <p><strong>Role:</strong> <span th:text="${session.userrole}">Role</span></p>
                
                <hr>
                <h6>Quick Actions</h6>
                <div class="d-grid gap-2">
                    
                    
                    <a th:if="${session.userrole == 'admin'}" 
                       th:href="@{/admin/person/list}" class="btn btn-outline-primary">
                        Manage Members
                    </a>

                    <a th:if="${session.userrole == 'admin'}" 
                       th:href="@{/admin/categories/list}" class="btn btn-outline-info">
                        Manage Categories
                    </a>

                    <a th:if="${session.userrole == 'admin'}" 
                       th:href="@{/admin/programs/list}" class="btn btn-outline-warning">
                        Manage Programs
                    </a>

                    <a th:if="${session.userrole == 'admin'}" 
                       th:href="@{/admin/reports}" class="btn btn-outline-success">
                        System Reports
                    </a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\person-edit.html
Size: 6.31 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Edit Member</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .container-custom {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        h1 {
            color: #17477c;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        .form-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }
        .btn-group {
            margin-top: 30px;
            display: flex;
            gap: 10px;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <!-- Flash Messages -->
        <div th:replace="~{fragments :: flash-messages}"></div>
        
        <div class="container-custom">
            <h1>✏️ Edit Member Profile</h1>
            <p class="text-muted mb-4">Update member information below</p>
            
            <!-- Form bound to ${member} which is a Member object -->
            <form th:action="@{/admin/person/update}" th:object="${member}" method="post">
                <!-- Hidden ID field -->
                <input type="hidden" name="id" th:value="${member.id}">
                
                <!-- Name Field -->
                <div class="mb-3">
                    <label for="name" class="form-label">Full Name *</label>
                    <input type="text" 
                           id="name" 
                           th:field="*{name}" 
                           class="form-control" 
                           placeholder="Enter member's full name"
                           required>
                </div>
                
                <!-- Email Field -->
                <div class="mb-3">
                    <label for="email" class="form-label">Email Address *</label>
                    <input type="email" 
                           id="email" 
                           th:field="*{email}" 
                           class="form-control" 
                           placeholder="member@example.com"
                           required>
                </div>
                
                <!-- Phone Field -->
                <div class="mb-3">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input type="text" 
                           id="phone" 
                           th:field="*{phone}" 
                           class="form-control"
                           placeholder="01X-XXXXXXX">
                </div>
                
                <!-- Year of Birth Field -->
                <div class="mb-3">
                    <label for="yearOfBirth" class="form-label">Year of Birth *</label>
                    <input type="number" 
                           id="yearOfBirth" 
                           th:field="*{yearOfBirth}" 
                           class="form-control" 
                           min="1900" 
                           max="2025" 
                           placeholder="e.g., 1995"
                           required>
                </div>

                <!-- Gender Field -->
                <div class="mb-3">
                    <label class="form-label">Gender *</label><br>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" 
                               type="radio" 
                               th:field="*{gender}" 
                               value="Male" 
                               id="genderMale">
                        <label class="form-check-label" for="genderMale">Male</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" 
                               type="radio" 
                               th:field="*{gender}" 
                               value="Female" 
                               id="genderFemale">
                        <label class="form-check-label" for="genderFemale">Female</label>
                    </div>
                </div>

                <!-- Member Type Field -->
                <div class="mb-3">
                    <label for="memberType" class="form-label">Member Type *</label>
                    <select id="memberType" 
                            th:field="*{memberType}" 
                            class="form-select" 
                            required>
                        <option value="">-- Select Member Type --</option>
                        <option value="student">Student</option>
                        <option value="staff">Staff</option>
                        <option value="public">Public</option>
                    </select>
                </div>
                
                <!-- Read-only info -->
                <div class="alert alert-info">
                    <strong>ℹ️ Note:</strong> Username and password cannot be changed through this form. 
                    BMI data is managed separately through the BMI Calculator.
                </div>
                
                <!-- Buttons -->
                <div class="btn-group">
                    <button type="submit" class="btn btn-success btn-lg">
                        💾 Save Changes
                    </button>
                    <a th:href="@{/admin/person/list}" class="btn btn-secondary btn-lg">
                        ← Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\person-form.html
Size: 8.09 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Member Form</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .container-custom {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        h1 {
            color: #17477c;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        .form-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }
        .btn-group {
            margin-top: 30px;
            display: flex;
            gap: 10px;
        }
        .required::after {
            content: " *";
            color: red;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <!-- Flash Messages -->
        <div th:replace="~{fragments :: flash-messages}"></div>
        
        <div class="container-custom">
            <!-- Dynamic Title -->
            <h1 th:text="${member.id == null} ? '➕ Create New Member' : '✏️ Edit Member'">
                Member Form
            </h1>
            
            <!-- Form - Dynamic action based on create/edit -->
            <form th:action="${member.id == null} ? @{/admin/person/create} : @{/admin/person/update}" 
                  th:object="${member}" 
                  method="post">
                
                <!-- Hidden ID field (only for edit) -->
                <input type="hidden" th:if="${member.id != null}" name="id" th:value="${member.id}">
                
                <!-- Name Field -->
                <div class="mb-3">
                    <label for="name" class="form-label required">Full Name</label>
                    <input type="text" 
                           id="name" 
                           th:field="*{name}" 
                           class="form-control" 
                           placeholder="Enter member's full name"
                           required>
                </div>
                
                <!-- Username Field (Required for new members) -->
                <div class="mb-3">
                    <label for="username" class="form-label required">Username</label>
                    <input type="text" 
                           id="username" 
                           th:field="*{username}" 
                           class="form-control" 
                           placeholder="Choose a unique username"
                           th:readonly="${member.id != null}"
                           required>
                    <small class="text-muted" th:if="${member.id != null}">
                        Username cannot be changed after creation
                    </small>
                </div>
                
                <!-- Password Field (Required for new members) -->
                <div class="mb-3" th:if="${member.id == null}">
                    <label for="password" class="form-label required">Password</label>
                    <input type="password" 
                           id="password" 
                           th:field="*{password}" 
                           class="form-control" 
                           placeholder="Set initial password"
                           required>
                </div>
                
                <!-- Email Field -->
                <div class="mb-3">
                    <label for="email" class="form-label required">Email Address</label>
                    <input type="email" 
                           id="email" 
                           th:field="*{email}" 
                           class="form-control" 
                           placeholder="member@example.com"
                           required>
                </div>
                
                <!-- Phone Field -->
                <div class="mb-3">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input type="text" 
                           id="phone" 
                           th:field="*{phone}" 
                           class="form-control"
                           placeholder="01X-XXXXXXX">
                </div>
                
                <!-- Year of Birth Field -->
                <div class="mb-3">
                    <label for="yearOfBirth" class="form-label required">Year of Birth</label>
                    <input type="number" 
                           id="yearOfBirth" 
                           th:field="*{yearOfBirth}" 
                           class="form-control" 
                           min="1900" 
                           max="2025" 
                           placeholder="e.g., 1995"
                           required>
                </div>

                <!-- Gender Field -->
                <div class="mb-3">
                    <label class="form-label required">Gender</label><br>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" 
                               type="radio" 
                               th:field="*{gender}" 
                               value="Male" 
                               id="genderMale">
                        <label class="form-check-label" for="genderMale">Male</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" 
                               type="radio" 
                               th:field="*{gender}" 
                               value="Female" 
                               id="genderFemale">
                        <label class="form-check-label" for="genderFemale">Female</label>
                    </div>
                </div>

                <!-- Member Type Field -->
                <div class="mb-3">
                    <label for="memberType" class="form-label required">Member Type</label>
                    <select id="memberType" 
                            th:field="*{memberType}" 
                            class="form-select" 
                            required>
                        <option value="">-- Select Member Type --</option>
                        <option value="student">Student</option>
                        <option value="staff">Staff</option>
                        <option value="public">Public</option>
                    </select>
                </div>
                
                <!-- Info Alert -->
                <div class="alert alert-info" th:if="${member.id != null}">
                    <strong>ℹ️ Note:</strong> Password cannot be changed through this form. 
                    BMI data is managed separately through the BMI Calculator.
                </div>
                
                <!-- Buttons -->
                <div class="btn-group">
                    <button type="submit" class="btn btn-success btn-lg">
                        <span th:if="${member.id == null}">➕ Create Member</span>
                        <span th:if="${member.id != null}">💾 Save Changes</span>
                    </button>
                    <a th:href="@{/admin/person/list}" class="btn btn-secondary btn-lg">
                        ← Cancel
                    </a>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\person-list.html
Size: 3.33 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>
<body>

    <!-- Use the new navigation -->
    <div th:replace="~{fragments :: main-menu}"></div>
    
    <!-- Optional: Flash messages -->
    <div class="container">
        <div th:replace="~{fragments :: flash-messages}"></div>

        <div class="container mt-4">
            <h1 class="mb-3">Admin Panel: Member Records</h1>

            <form th:action="@{/admin/person/list}" method="get" class="mb-3 d-flex">
                <input type="text" name="searchName" class="form-control me-2" 
                       placeholder="Search by name..." th:value="${param.searchName}">
                <button type="submit" class="btn btn-primary">Search</button>
            </form>

            <div class="alert alert-info small">
                Logged in as: <span th:text="${session.username}">User</span>
                (<span th:text="${session.userrole}">Role</span>)
            </div>

            <div th:if="${flashMessage}" class="alert alert-success alert-dismissible fade show">
                <span th:text="${flashMessage}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Age</th>
                        <th>Gender</th>
                        <th>BMI</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="p, status : ${persons}">
                        <td th:text="${status.count}">1</td>
                        <td th:text="${p.name}">Name</td>
                        <td th:text="${p.age}">Age</td>
                        <td th:text="${p.gender}">Gender</td>
                        <td th:text="${#numbers.formatDecimal(p.bmi, 1, 2)}">BMI</td>
                        <td>
                            <a th:href="@{/admin/person/view/{id}(id=${p.id})}" class="btn btn-sm btn-info">View</a>
                            <a th:href="@{/admin/person/edit/{id}(id=${p.id})}" class="btn btn-sm btn-warning ms-1">Edit</a>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <!-- Bottom Action Buttons -->
<div class="d-flex gap-2 mt-3">
    <!-- ✅ NEW: Create Member Button -->
    <a th:href="@{/admin/person/new}" class="btn btn-success">
        ➕ Create New Member
    </a>
    
    <!-- Keep existing BMI form button for logged-in members -->
    <a th:href="@{/bmi/form}" class="btn btn-primary" target="_blank">
        📊 BMI Calculator
    </a>
    
    <a th:href="@{/home}" class="btn btn-secondary">
        Return to Home
    </a>
</div>
        </div>
    </div>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\person-view.html
Size: 2.16 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>
<div class="container mt-4">
    <h1>Member Details</h1>
    <div class="card p-3">
        <p><strong>Name:</strong> <span th:text="${person.name}"></span></p>
        <p><strong>Age:</strong> <span th:text="${person.age}"></span> years</p>
        <p><strong>Gender:</strong> <span th:text="${person.gender}"></span></p>
        
        <div th:if="${person.height > 0}">
            <p><strong>Height:</strong> <span th:text="${#numbers.formatDecimal(person.height, 1, 2)}"></span> m</p>
            <p><strong>Weight:</strong> <span th:text="${#numbers.formatDecimal(person.weight, 1, 1)}"></span> kg</p>
            <p><strong>BMI:</strong> <span th:text="${#numbers.formatDecimal(person.bmi, 1, 2)}"></span></p>
            <p><strong>Category:</strong> <span th:text="${person.category}"></span></p>
        </div>
        <div th:unless="${person.height > 0}">
            <p class="text-muted">No BMI records available for this member.</p>
        </div>
        
        <p><strong>Interests:</strong></p>
        <ul th:if="${!person.interests.isEmpty()}">
            <li th:each="interest : ${person.interests}" th:text="${interest}"></li>
        </ul>
        <p th:if="${person.interests.isEmpty()}" class="text-muted">No interests recorded</p>
    </div>
    
    <a th:href="@{/admin/person/list}" class="btn btn-secondary mt-3">Back to List</a>

    <form th:action="@{/admin/person/delete}" method="post" class="d-inline">
        <input type="hidden" name="id" th:value="${person.id}">
        <button type="submit" class="btn btn-danger mt-3" 
                onclick="return confirm('Are you sure you want to delete this member and all their BMI records?')">
            Delete Member
        </button>
    </form>
</div>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\program-form.html
Size: 5.61 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>

<!-- Navigation Bar Fragment (Position UNCHANGED) -->
<div th:replace="~{fragments :: main-menu}"></div>

<div class="container mt-4">
    <h1 th:text="${pageTitle}">Program Form</h1>
    
    <!-- Form submission posts to /admin/programs/save -->
    <form th:action="@{/admin/programs/save}" th:object="${program}" method="post">
        
        <!-- Hidden ID field for distinguishing between SAVE (new) and UPDATE (existing) -->
        <input type="hidden" th:field="*{id}" />
        
        <!-- ROW 1: Name and Category -->
        <div class="row">
            <div class="col-md-7 mb-3">
                <label for="name" class="form-label">Program Name:</label>
                <input type="text" id="name" th:field="*{name}" class="form-control" required />
            </div>
            <div class="col-md-5 mb-3">
                <label for="categoryId" class="form-label">Category (Required):</label>
                <!-- Select element for Category -->
                <select id="categoryId" name="categoryId" class="form-select" required>
                    <option value="">-- Select Category --</option>
                    <option th:each="cat : ${categories}" 
                            th:value="${cat.id}" 
                            th:text="${cat.name}"
                            th:selected="${program.category != null and program.category.id == cat.id}">
                    </option>
                </select>
            </div>
        </div>

        <!-- ROW 2: Trainer and Difficulty -->
        <div class="row">
            <div class="col-md-7 mb-3">
                <label for="trainerId" class="form-label">Assigned Trainer:</label>
                <!-- Select element for Trainer -->
                <select id="trainerId" name="trainerId" class="form-select">
                    <option value="">-- Select Trainer --</option>
                    <option th:each="trainer : ${trainers}" 
                            th:value="${trainer.id}" 
                            th:text="${trainer.name} + ' (' + ${trainer.specialization} + ')'"
                            th:selected="${program.trainer != null and program.trainer.id == trainer.id}">
                    </option>
                </select>
            </div>
            <div class="col-md-5 mb-3">
                <label for="difficultyLevel" class="form-label">Difficulty Level:</label>
                <select id="difficultyLevel" th:field="*{difficultyLevel}" class="form-select">
                    <option value="">-- Select Level --</option>
                    <option value="Beginner">Beginner</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Advanced">Advanced</option>
                </select>
            </div>
        </div>
        
        <!-- ROW 3: Duration, Price, Max Participants -->
        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="durationWeeks" class="form-label">Duration (Weeks):</label>
                <input type="number" id="durationWeeks" th:field="*{durationWeeks}" class="form-control" min="1" required />
            </div>
            <div class="col-md-4 mb-3">
                <label for="price" class="form-label">Price (MYR):</label>
                <input type="number" id="price" th:field="*{price}" class="form-control" step="0.01" min="0" required />
            </div>
            <div class="col-md-4 mb-3">
                <label for="maxParticipants" class="form-label">Max Participants:</label>
                <input type="number" id="maxParticipants" th:field="*{maxParticipants}" class="form-control" min="1" />
            </div>
        </div>

        <!-- ROW 4: Description -->
        <div class="mb-3">
            <label for="description" class="form-label">Program Description:</label>
            <textarea id="description" th:field="*{description}" class="form-control" rows="5" placeholder="Provide a detailed description of the program, its goals, and requirements."></textarea>
        </div>
        
        <!-- ROW 5: Status -->
        <div class="form-check mb-4">
            <input type="checkbox" id="isActive" th:field="*{isActive}" class="form-check-input" style="margin-top: 0.35em;" />
            <label class="form-check-label" for="isActive" style="display: flex; align-items: center;">Program is Active (Available for Enrollment)</label>
        </div>

        <div class="d-flex justify-content-between mt-4">
            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary-custom btn-lg">
                <span th:if="${program.id == null}">Create New Program</span>
                <span th:unless="${program.id == null}">Update Program</span>
            </button>
            
            <!-- Back Button -->
            <a th:href="@{/admin/programs/list}" class="btn btn-secondary btn-lg">
                Cancel / Back to List
            </a>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\program-list.html
Size: 3.64 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>

<!-- Navigation Bar Fragment (Position UNCHANGED) -->
<div th:replace="~{fragments :: main-menu}"></div>

<div class="container mt-4">
    <h1 th:text="${pageTitle}">Manage Fitness Programs</h1>
    
    <!-- Flash Message -->
    <div th:if="${flashMessage}" class="flash-message">
        <span th:text="${flashMessage}"></span>
    </div>

    <div class="d-flex justify-content-between mb-4">
        <!-- Add New Program Button: Visible only if NOT a filtered view -->
        <a th:if="${!isFilteredView}" th:href="@{/admin/programs/new}" class="btn action-button btn-success">
            + Add New Program
        </a>
        
        <!-- Placeholder/Spacer for alignment -->
        <div th:if="${!isFilteredView}"></div> 
    </div>
    
    <!-- Table to Display Programs -->
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th style="width: 5%;">ID</th>
                <th style="width: 20%;">Name</th>
                <th style="width: 15%;">Category</th>
                <th style="width: 15%;">Duration (Weeks)</th>
                <th style="width: 10%;">Price</th>
                <th style="width: 10%;">Level</th>
                <th style="width: 25%;">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="program : ${programs}">
                <td th:text="${program.id}">1</td>
                <td th:text="${program.name}">Intro to HIIT</td>
                <td th:text="${program.category?.name}">Cardio</td> 
                <td th:text="${program.durationWeeks}">4</td>
                <td th:text="${#numbers.formatCurrency(program.price)}">99.00</td>
                <td th:text="${program.difficultyLevel}">Beginner</td>
                <td class="action-links">
                    
                    <!-- NEW VIEW BUTTON -->
                    <a th:href="@{/admin/programs/view/{id}(id=${program.id})}" 
                       class="btn btn-info btn-sm">
                        View
                    </a>
                    
                    <a th:href="@{/admin/programs/edit/{id}(id=${program.id})}" 
                       class="btn btn-primary btn-sm">
                        Edit
                    </a>
                    
                    <a th:href="@{/admin/programs/delete/{id}(id=${program.id})}" 
                       onclick="return confirm('Are you sure you want to delete this program?');"
                       class="btn btn-danger btn-sm">
                        Delete
                    </a>
                </td>
            </tr>
        </tbody>
    </table>
    
    <p th:if="${programs.isEmpty()}" class="alert alert-warning mt-4">
        No programs found matching the current view.
    </p>

    <!-- BACK BUTTON (Bottom): Visible only if it IS a filtered view -->
    <div th:if="${isFilteredView}" class="mt-4 text-center">
        <a th:href="@{/admin/categories/list}" class="btn btn-secondary action-button">
            &larr; Back to Category List
        </a>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\program-view.html
Size: 2.73 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>

<!-- Navigation Bar Fragment (Position UNCHANGED) -->
<div th:replace="~{fragments :: main-menu}"></div>

<div class="container mt-4">
    <h1 th:text="${pageTitle}">Program Details</h1>

    <!-- Program Summary -->
    <div class="row mb-4">
        <div class="col-md-6 detail-item">
            <strong>Category:</strong>
            <span th:text="${program.category?.name}">Fitness</span>
        </div>
        <div class="col-md-6 detail-item">
            <strong>Difficulty Level:</strong>
            <span th:text="${program.difficultyLevel}">Intermediate</span>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-6 detail-item">
            <strong>Duration:</strong>
            <span th:text="${program.durationWeeks} + ' weeks'">8 weeks</span>
        </div>
        <div class="col-md-6 detail-item">
            <strong>Price:</strong>
            <span th:text="${#numbers.formatCurrency(program.price)}">$49.99</span>
        </div>
    </div>

    <!-- Description -->
    <h2 class="h4 mt-4 mb-3" style="color: #007bff;">Program Description</h2>
    <div class="description-box mb-4">
        <p th:text="${program.description}">Detailed program description goes here.</p>
    </div>

    <!-- Trainer Information -->
    <h2 class="h4 mt-4 mb-3" style="color: #007bff;">Assigned Trainer Details</h2>
    <div class="card detail-card">
        <div class="card-body" th:if="${program.trainer != null}">
            <p><strong>Name:</strong> <span th:text="${program.trainer.name}">Jane Doe</span></p>
            <p><strong>Email:</strong> <span th:text="${program.trainer.email}">jane.doe@healthhub.com</span></p>
            <p><strong>Contact:</strong> <span th:text="${program.trainer.phone}">+6012-3456789</span></p>
        </div>
        <div class="card-body text-muted" th:if="${program.trainer == null}">
            <p>No trainer currently assigned to this program.</p>
        </div>
    </div>

    <!-- Back to Program List Button -->
    <div class="mt-5 text-end">
        <a th:href="@{/admin/programs/list}" class="btn btn-secondary btn-lg">
            &larr; Back to Program List
        </a>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\admin\reports.html
Size: 3.92 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Admin Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
    </style>
</head>

<body>

<!-- Navigation Bar Fragment (Position UNCHANGED) -->
<div th:replace="~{fragments :: main-menu}"></div>

<div class="container mt-4">
    <h1 th:text="${pageTitle}">System Summary & Reports</h1>
    
    <h2 class="h5 mb-4 text-primary">System Overviews</h2>
    
    <!-- Row of Key Performance Indicators (KPIs) -->
    <div class="row mb-5">
        
        <!-- KPI Card 1: Total Users -->
        <div class="col-md-4">
            <div class="card report-card border-primary">
                <div class="card-body">
                    <p class="card-title">Total Registered Users</p>
                    <!-- Displayed using the model attribute passed from the controller -->
                    <h3 class="card-number" th:text="${totalUsers != null ? totalUsers : 0}">450</h3>
                </div>
            </div>
        </div>
        
        <!-- KPI Card 2: Total Programs -->
        <div class="col-md-4">
            <div class="card report-card border-success">
                <div class="card-body">
                    <p class="card-title">Active Fitness Programs</p>
                    <h3 class="card-number" th:text="${totalPrograms != null ? totalPrograms : 0}">15</h3>
                </div>
            </div>
        </div>
        
        <!-- KPI Card 3: Total Enrollments -->
        <div class="col-md-4">
            <div class="card report-card border-info">
                <div class="card-body">
                    <p class="card-title">Total Program Enrollments</p>
                    <h3 class="card-number" th:text="${totalEnrollments != null ? totalEnrollments : 0}">678</h3>
                </div>
            </div>
        </div>
    </div>
    
    <h2 class="h5 mb-3 text-primary">Enrollment Details</h2>

    <!-- Table: Top Enrolled Programs -->
    <div class="card p-3">
        <h3 class="h6 mb-3">Top 5 Most Popular Programs</h3>
        <table class="table table-sm table-striped">
            <thead>
                <tr>
                    <th style="width: 5%;">#</th>
                    <th>Program Name</th>
                    <th>Category</th>
                    <th style="width: 20%;" class="text-end">Enrollment Count</th>
                </tr>
            </thead>
            <tbody>
                <!-- Iterate over the list of popular programs -->
                <tr th:each="program, stat : ${popularPrograms}">
                    <td th:text="${stat.count}">1</td>
                    <td th:text="${program.name}">Summer Shred</td>
                    <td th:text="${program.category?.name}">Strength</td>
                    
                    <!-- UPDATED: Use the enrollmentCounts map to look up the count by Program ID -->
                    <td th:text="${enrollmentCounts.get(program.id)}" class="text-end">150</td> 
                </tr>
            </tbody>
            <tfoot th:if="${popularPrograms == null or popularPrograms.isEmpty()}">
                 <tr>
                    <td colspan="4" class="text-center text-muted">No enrollment data available yet.</td>
                </tr>
            </tfoot>
        </table>
    </div>
    
    <div class="mt-5 pt-3 border-top text-muted">
        <p class="small">Report generated on: <span th:text="${#dates.format(#dates.createNow(), 'dd MMMM yyyy HH:mm:ss')}"></span></p>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\bmi-form.html
Size: 6.83 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : BMI Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            margin: 0; 
            padding: 20px; 
        }
        .card { 
            max-width: 600px; 
            margin: 20px auto; 
            background: #fff; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.1); 
        }
        h1 { 
            text-align: center; 
            font-size: 1.8em; 
            color: #333; 
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1em;
        }
        label { 
            display: block; 
            margin: 15px 0 5px; 
            font-weight: 600;
            color: #555;
            font-size: 0.95em;
        }
        input[type=number] { 
            width: 100%; 
            padding: 10px 12px; 
            border: 2px solid #e0e0e0; 
            border-radius: 8px; 
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        input[type=number]:focus {
            border-color: #007bff;
            outline: none;
        }
        .row-custom { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
        }
        .interests { 
            margin: 15px 0 20px; 
        }
        .interests label { 
            font-weight: normal; 
            display: inline-block; 
            margin-right: 15px;
            font-size: 0.95em;
        }
        button { 
            display: block; 
            width: 100%; 
            background: #007bff;
            color: #fff; 
            border: none; 
            padding: 12px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 1.1em;
            font-weight: 600;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        button:hover { 
            background: #0056b3;
        }
        .error-text { 
            color: #D8000C; 
            font-size: 0.9em;
            margin-top: 5px;
        }
        .info-display {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .info-display p {
            margin: 5px 0;
            color: #333;
        }
        .info-display strong {
            color: #007bff;
        }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>

    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

        <div class="card">
            <h1>📊 BMI Calculator</h1>
            <p class="subtitle">Track Your Body Mass Index</p>

            <!-- Display Member Info (Read-Only) -->
            <div class="info-display">
                <p><strong>Logged in as:</strong> <span th:text="${bmiRecord.name}">Member Name</span></p>
                <p><strong>Age:</strong> <span th:text="${2025 - bmiRecord.yearOfBirth}">25</span> years old</p>
                <p><strong>Gender:</strong> <span th:text="${bmiRecord.gender}">Male</span></p>
            </div>

            <!-- ✅ PROPER THYMELEAF FORM -->
            <form th:action="@{/bmi/calculate}" 
                  th:object="${bmiRecord}" 
                  method="post"
                  onsubmit="console.log('Form submitting to:', this.action); return true;">

                <!-- ✅ HIDDEN FIELDS - Pre-filled from member data -->
                <input type="hidden" th:field="*{name}">
                <input type="hidden" th:field="*{yearOfBirth}">
                <input type="hidden" th:field="*{gender}">

                <!-- ✅ ONLY ASK FOR BMI-SPECIFIC DATA -->
                <div class="row-custom">
                    <div>
                        <label for="height">Height (meters) *</label>
                        <input type="number" id="height" th:field="*{height}" 
                               step="0.01" min="0.5" max="2.5" required 
                               placeholder="e.g., 1.75">
                        <div th:if="${#fields.hasErrors('height')}" 
                             th:errors="*{height}" class="error-text">Height Error</div>
                    </div>
                    <div>
                        <label for="weight">Weight (kg) *</label>
                        <input type="number" id="weight" th:field="*{weight}" 
                               step="0.1" min="20" max="300" required 
                               placeholder="e.g., 70">
                        <div th:if="${#fields.hasErrors('weight')}" 
                             th:errors="*{weight}" class="error-text">Weight Error</div>
                    </div>
                </div>

                <!-- ✅ OPTIONAL: Keep interests if you want -->
                <div class="interests">
                    <label style="font-weight: 600; color: #555;">Interests (Optional)</label><br>
                    <label><input type="checkbox" name="interests" value="Entertainment"> Entertainment</label><br>
                    <label><input type="checkbox" name="interests" value="Sports"> Sports</label><br>
                    <label><input type="checkbox" name="interests" value="Travel"> Travel</label><br>
                    <label><input type="checkbox" name="interests" value="Business"> Business</label><br>
                    <label><input type="checkbox" name="interests" value="Technology"> Technology</label>
                </div>

                <button type="submit">Calculate My BMI</button>
            </form>
            
            <div class="text-center mt-3">
                <a th:href="@{/member/dashboard}" class="btn btn-secondary">
                    ← Back to Dashboard
                </a>
            </div>
        </div>
    </div>

    <script>
        // Debug: Log form details on page load
        window.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('form');
            console.log('Form action URL:', form.action);
            console.log('Form method:', form.method);
        });
    </script>

</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\bmi-result.html
Size: 4.83 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : BMI Result</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            margin: 0; 
            padding: 20px; 
        }
        .card { 
            max-width: 600px; 
            margin: 20px auto; 
            background: #fff; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.1); 
        }
        h1 { 
            text-align: center; 
            font-size: 1.8em; 
            color: #333; 
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1em;
        }
        .success-banner {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .result-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 20px; 
        }
        .result-table td { 
            padding: 12px 10px; 
            border-bottom: 1px solid #eee; 
        }
        .result-table td:first-child { 
            font-weight: 600; 
            color: #555; 
            width: 40%;
        }
        .bmi-value { 
            font-size: 2em; 
            font-weight: bold; 
            color: #007bff; 
        }
        .category-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1em;
        }
        .badge-underweight { background: #ffc107; color: #000; }
        .badge-normal { background: #28a745; color: #fff; }
        .badge-overweight { background: #fd7e14; color: #fff; }
        .badge-obese { background: #dc3545; color: #fff; }
        .action-buttons {
            text-align: center;
            margin-top: 30px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>

    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

        <div class="card">
            <h1>✅ BMI Calculation Complete</h1>
            <p class="subtitle">Your latest health metrics</p>
            
            <!-- Success Message -->
            <div th:if="${message}" class="success-banner">
                <span th:text="${message}">BMI calculated and saved successfully!</span>
            </div>
            
            <!-- Results Table -->
            <table class="result-table">
                <tr>
                    <td>Name:</td>
                    <td th:text="${bmiRecord.name}">Member Name</td>
                </tr>
                <tr>
                    <td>Age:</td>
                    <td th:text="${bmiRecord.age} + ' years old'">25 years old</td>
                </tr>
                <tr>
                    <td>Height:</td>
                    <td th:text="${#numbers.formatDecimal(bmiRecord.height, 1, 2)} + ' m'">1.75 m</td>
                </tr>
                <tr>
                    <td>Weight:</td>
                    <td th:text="${#numbers.formatDecimal(bmiRecord.weight, 1, 1)} + ' kg'">70 kg</td>
                </tr>
                <tr>
                    <td>BMI Value:</td>
                    <td class="bmi-value" th:text="${#numbers.formatDecimal(bmiRecord.bmi, 1, 2)}">24.5</td>
                </tr>
                <tr>
                    <td>Category:</td>
                    <td>
                        <span class="category-badge badge-normal" th:text="${bmiRecord.category}">
                            Normal Weight
                        </span>
                    </td>
                </tr>
            </table>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <a th:href="@{/bmi/form}" class="btn btn-primary btn-lg">
                    📊 Calculate Again
                </a>
                <a th:href="@{/bmi/history}" class="btn btn-success btn-lg">
                    📈 View History
                </a>
                <a th:href="@{/member/dashboard}" class="btn btn-secondary btn-lg">
                    ← Dashboard
                </a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\fragments.html
Size: 7.38 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="common-head">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthHub@UTM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <style>
        .btn-logout-nav {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        .btn-logout-nav:hover {
            background-color: #c82333;
            color: white;
        }
        .navbar-right-section { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        .user-info-badge { 
            margin-right: 8px; 
        }
        .role-badge { 
            margin-left: 6px; 
            font-size: 0.85em; 
            padding: 2px 6px; 
            border-radius: 12px; 
            background: #e9ecef; 
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<!-- ============================================
     MAIN NAVIGATION MENU
     ============================================ -->
<div th:fragment="main-menu" class="mb-4">
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">
            <!-- Brand -->
            <a class="navbar-brand" th:href="@{/home}">
                🏥 HealthHub@UTM
            </a>
            
            <!-- Mobile Toggle Button -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <!-- Navigation Links -->
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    
                    <!-- ADMIN MENU -->
                    <th:block th:if="${session.userrole == 'admin'}">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/dashboard}">🏠 Dashboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/person/list}">👥 Members</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/categories/list}">📂 Categories</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/programs/list}">📋 Programs</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/reports}">📊 Reports</a>
                        </li>
                    </th:block>
                    
                    <!-- TRAINER MENU -->
                    <th:block th:if="${session.userrole == 'trainer'}">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/trainer/dashboard}">🏠 Dashboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/trainer/plans}">📋 Workout Plans</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/trainer/plans/new}">➕ Create Plan</a>
                        </li>
                    </th:block>
                    
                    <!-- MEMBER MENU -->
                    <th:block th:if="${session.userrole == 'member'}">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/member/dashboard}">🏠 Dashboard</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/member/programs}">📚 Programs</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/member/enrollments}">📝 My Enrollments</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/member/workout-plans}">💪 Workout Plans</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/bmi/form}">📊 BMI Calculator</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/bmi/history}">🕒 BMI History</a>
                        </li>
                    </th:block>
                    
                    <!-- GUEST MENU -->
                    <th:block th:if="${session.userrole == null}">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/login}">🔐 Login</a>
                        </li>
                    </th:block>
                </ul>
                
                <!-- Right Side: User Info + Logout -->
                <div class="navbar-right-section">
                    <span th:if="${session.username != null}" class="user-info-badge">
                        👤 <span th:text="${session.username}">User</span>
                        <span class="role-badge" th:text="${session.userrole}">Role</span>
                    </span>
                    
                    <a th:if="${session.username != null}" 
                       th:href="@{/logout}" 
                       class="btn-logout-nav">
                        🚪 Logout
                    </a>
                </div>
            </div>
        </div>
    </nav>
</div>

<!-- ============================================
     FLASH MESSAGES
     ============================================ -->
<div th:fragment="flash-messages">
    <div th:if="${successMessage}" 
         class="alert alert-success alert-dismissible fade show" 
         role="alert">
        <strong>✅ Success!</strong> <span th:text="${successMessage}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    
    <div th:if="${errorMessage}" 
         class="alert alert-danger alert-dismissible fade show" 
         role="alert">
        <strong>❌ Error!</strong> <span th:text="${errorMessage}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    
    <div th:if="${flashMessage}" 
         class="alert alert-info alert-dismissible fade show" 
         role="alert">
        <strong>ℹ️ Info:</strong> <span th:text="${flashMessage}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
</div>

</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\index.html
Size: 1.82 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: common-head}"></head>
<body>
    <div th:replace="~{fragments :: main-menu}"></div>

    <div class="container mt-4">
        <div class="card">
            <div class="card-body text-center">
                <h1 class="display-4">Welcome to HealthHub@UTM</h1>
                <p class="lead mt-3">Hello, <strong th:text="${session.username}">User</strong>!</p>
                <hr class="my-4">
                <p>Your health management platform</p>
                
                <div class="row mt-4">
                    <div class="col-md-6 mb-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h5 class="card-title">📊 BMI Calculator</h5>
                                <p class="card-text">Calculate your Body Mass Index</p>
                                <a th:href="@{/bmi/form}" class="btn btn-primary" target="_blank">Go to Calculator</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-3" th:if="${session.userrole == 'admin'}">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h5 class="card-title">👥 Admin Panel</h5>
                                <p class="card-text">Manage member records</p>
                                <a th:href="@{/admin/person/list}" class="btn btn-info">Go to Admin</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\login.html
Size: 3.19 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Login - HealthHub@UTM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h3 class="card-title text-center mb-4">HealthHub@UTM Login</h3>

                    <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
                        <span th:text="${errorMessage}"></span>
                    </div>
                    
                    <div th:if="${param.logoutMsg}" class="alert alert-success" role="alert">
                        <span th:text="${param.logoutMsg}"></span>
                    </div>

                    <form th:action="@{/login}" method="post">
                        <div class="mb-3">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" class="form-control" id="username" name="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Login</button>
                    </form>
                    
                    <!-- ✅ NEW: Registration Link -->
                    <div class="text-center mt-3 pt-3 border-top">
                        <p class="mb-0">Don't have an account? 
                            <a th:href="@{/register}" class="text-decoration-none fw-bold">Register here</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-4 mt-4 mt-md-0">
            <div class="card bg-light">
                <div class="card-body">
                    <h5 class="card-title">Test Credentials</h5>
                    <p class="mb-2">
                        <b>Role:</b> Member<br>
                        <b>User:</b> <code>userpass</code><br>
                        <b>Pass:</b> <code>userpass</code>
                    </p>
                    <hr>
                    <p class="mb-2">
                        <b>Role:</b> Admin<br>
                        <b>User:</b> <code>admin</code><br>
                        <b>Pass:</b> <code>admin123</code>
                    </p>
                    <hr>
                    <p class="mb-1">
                        <b>Role:</b> Trainer<br>
                        <b>User:</b> <code>trainer</code><br>
                        <b>Pass:</b> <code>trainer123</code>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\member\bmi-history.html
Size: 7.82 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:insert="~{fragments :: common-head}"></th:block>
    <title>HealthHub@UTM : My BMI History</title>
    <style>
        body { 
            font-family: Arial, sans-serif;
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .container-custom { 
            max-width: 1200px; 
            margin: 0 auto; 
        }
        h1 { 
            text-align: center; 
            color: #17477c; 
            margin-bottom: 5px; 
            font-weight: 700;
        }
        .subtitle { 
            text-align: center; 
            color: #6c757d; 
            margin-bottom: 40px; 
        }
        
        /* Latest BMI Card */
        .latest-bmi-card {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 8px 25px rgba(0, 123, 255, 0.3);
        }
        .latest-bmi-value {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
        }
        .latest-bmi-category {
            font-size: 1.5em;
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 50px;
            display: inline-block;
            margin-top: 10px;
        }
        
        /* History Table */
        .history-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .history-table table {
            width: 100%;
            border-collapse: collapse;
        }
        .history-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #dee2e6;
        }
        .history-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .history-table tr:hover {
            background: #f8f9fa;
        }
        
        /* BMI Category Badges */
        .badge-underweight { background: #ffc107; color: #000; }
        .badge-normal { background: #28a745; color: #fff; }
        .badge-overweight { background: #fd7e14; color: #fff; }
        .badge-obese { background: #dc3545; color: #fff; }
        
        .bmi-badge {
            padding: 5px 12px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9em;
            display: inline-block;
        }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

        <div class="container-custom">
            <h1><i class="fas fa-chart-line"></i> My BMI History</h1>
            <p class="subtitle">Track your Body Mass Index progress over time</p>

            <div th:if="${bmiHistory != null and !bmiHistory.isEmpty()}" class="latest-bmi-card">
                <div class="row align-items-center">
                    <div class="col-md-6 text-center">
                        <h3 style="margin: 0;">Current BMI</h3>
                        <div class="latest-bmi-value" th:text="${#numbers.formatDecimal(bmiHistory[0].bmi, 1, 2)}">
                            24.5
                        </div>
                        <div class="latest-bmi-category" th:text="${bmiHistory[0].category}">
                            Normal Weight
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h5>Latest Measurement</h5>
                        <p style="margin: 8px 0;">
                            <strong>Date:</strong> 
                            <span th:text="${#temporals.format(bmiHistory[0].recordedAt, 'dd MMM yyyy HH:mm')}">
                                10 Dec 2025 14:30
                            </span>
                        </p>
                        <p style="margin: 8px 0;">
                            <strong>Weight:</strong> 
                            <span th:text="${#numbers.formatDecimal(bmiHistory[0].weight, 1, 1)} + ' kg'">70.0 kg</span>
                        </p>
                        <p style="margin: 8px 0;">
                            <strong>Height:</strong> 
                            <span th:text="${#numbers.formatDecimal(bmiHistory[0].height, 1, 2)} + ' m'">1.75 m</span>
                        </p>
                    </div>
                </div>
            </div>

            <div th:if="${bmiHistory == null or bmiHistory.isEmpty()}" class="alert alert-info text-center">
                <i class="fas fa-info-circle"></i> 
                You haven't recorded any BMI measurements yet. 
                <a th:href="@{/bmi/form}" class="alert-link">Click here to calculate your first BMI</a>
            </div>

            <div th:if="${bmiHistory != null and !bmiHistory.isEmpty()}" class="history-table">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Date & Time</th>
                            <th>Weight (kg)</th>
                            <th>Height (m)</th>
                            <th>BMI</th>
                            <th>Category</th>
                            <th>Age at Record</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="record, stat : ${bmiHistory}">
                            <td th:text="${stat.count}">1</td>
                            <td th:text="${#temporals.format(record.recordedAt, 'dd MMM yyyy HH:mm')}">
                                10 Dec 2025 14:30
                            </td>
                            <td th:text="${#numbers.formatDecimal(record.weight, 1, 1)}">70.0</td>
                            <td th:text="${#numbers.formatDecimal(record.height, 1, 2)}">1.75</td>
                            <td>
                                <strong th:text="${#numbers.formatDecimal(record.bmi, 1, 2)}">24.5</strong>
                            </td>
                            <td>
                                <span class="bmi-badge"
                                      th:classappend="${record.category == 'Underweight'} ? 'badge-underweight' : 
                                                      (${record.category == 'Normal weight'} ? 'badge-normal' : 
                                                      (${record.category == 'Overweight'} ? 'badge-overweight' : 
                                                      'badge-obese'))"
                                      th:text="${record.category}">
                                      Normal Weight
                                </span>
                            </td>
                            <td th:text="${record.age} + ' years'">25 years</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="text-center mt-4 mb-5">
                <a th:href="@{/bmi/form}" class="btn btn-primary btn-lg">
                    <i class="fas fa-calculator"></i> Record New BMI
                </a>
                <a th:href="@{/member/dashboard}" class="btn btn-secondary btn-lg ms-2">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </a>
            </div>
        </div>
    </div>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\member\dashboard.html
Size: 5.95 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Member Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .container-custom { 
            max-width: 1100px; 
            margin: 0 auto; 
        }
        h1 { 
            font-weight: 700;
            color: #17477c; 
            margin-bottom: 20px; 
        }
        .info-card {
            background: #fff;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%; /* Ensures cards in a row are the same height */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        .card-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: #007bff; /* Default blue */
        }
        .card-title {
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .card-value {
            font-size: 2.5em;
            font-weight: bold;
        }
        .link-button {
            margin-top: 15px;
        }
        /* Custom Colors for Cards */
        .card-enrollment .card-icon { color: #28a745; }
        .card-plan .card-icon { color: #ffc107; }
        .card-programs .card-icon { color: #17a2b8; }

    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>


<div class="container-custom">
<h1 th:text="'Welcome Back, ' + ${session.username ?: 'Member'} + '!'">Welcome Back, Member!</h1>    <p class="text-muted mb-4">Your personalized health and fitness summary.</p>

    <div class="row">
        
        <div class="col-md-4 mb-4">
    <div class="info-card card-enrollment">
        <div>
            <i class="fas fa-calendar-check card-icon"></i>
            <div class="card-title">My Enrollments</div>
            
            <div class="card-value text-success" th:text="${activeEnrollments}">0</div> 
            <p class="text-muted">Active Programs</p>
            
            <p class="text-warning mb-0" th:if="${pendingPayments > 0}">
                Payment for <span th:text="${pendingPayments}">0</span> program(s) is pending.
            </p>
            <p class="text-success mb-0" th:unless="${pendingPayments > 0}">
                All payments up to date!
            </p>
        </div>
        <a th:href="@{/member/enrollments}" class="btn btn-success link-button">View My Enrollments</a>
    </div>
</div>

<div class="col-md-4 mb-4">
    <div class="info-card card-plan">
        <div>
            <i class="fas fa-dumbbell card-icon"></i>
            <div class="card-title">Current Workout Plan</div>
            
            <div th:if="${activePlan != null}">
                <div class="card-value text-warning">Active</div>
                <p class="text-muted" th:text="'&quot;' + ${activePlan.name} + '&quot;'">Plan Name</p>
                <p class="text-secondary mb-0">
                    Assigned by Trainer: <span th:text="${activePlan.trainer != null ? activePlan.trainer.name : 'N/A'}">Trainer</span>
                </p>
            </div>
            <div th:unless="${activePlan != null}">
                <div class="card-value text-muted">None</div>
                <p class="text-muted">No active workout plan assigned</p>
            </div>
        </div>
        <a th:href="@{/member/workout-plans}" class="btn btn-warning link-button">Go to Workout Plans</a>
    </div>
</div>

<div class="col-md-4 mb-4">
    <div class="info-card card-programs">
        <div>
            <i class="fas fa-list-alt card-icon"></i>
            <div class="card-title">Explore Programs</div>
            
            <div class="card-value text-info" th:text="${totalPrograms}">0</div> 
            <p class="text-muted">Total Active Programs Available</p>

            <p class="text-secondary mb-0">Find your next fitness challenge.</p>
        </div>
        <a th:href="@{/member/programs}" class="btn btn-info link-button">Browse All Programs</a>
    </div>
</div>


<div class="col-md-4 mb-4">
    <div class="info-card card-bmi">
        <div>
            <i class="fas fa-weight card-icon"></i>
            <div class="card-title">My BMI Status</div>
            
            <div th:if="${latestBmi != null}">
                <div class="card-value text-info" 
                     th:text="${#numbers.formatDecimal(latestBmi.bmi, 1, 2)}">24.5</div>
                <p class="text-muted" th:text="${latestBmi.category}">Normal Weight</p>
                <p class="text-secondary mb-0">
                    Total Records: <span th:text="${bmiRecordCount}">5</span>
                </p>
            </div>
            <div th:unless="${latestBmi != null}">
                <div class="card-value text-muted">No Data</div>
                <p class="text-muted">Calculate your first BMI</p>
            </div>
        </div>
        <a th:href="@{/bmi/form}" class="btn btn-info link-button">Calculate BMI</a>
    </div>
</div>
        
    </div>

</div>

<script src="https://kit.fontawesome.com/your-font-awesome-kit.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\member\enroll-form.html
Size: 3.51 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Enroll in a Program</title>
    <style>
        body { background-color: #f6f8fb; padding: 20px; }
        .card { max-width: 800px; margin: 20px auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; margin-bottom: 5px; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
        .program-item { border: 1px solid #e0e0e0; border-radius: 8px; margin-bottom: 20px; padding: 20px; transition: box-shadow 0.3s; }
        .program-item:hover { box-shadow: 0 4px 15px rgba(0, 123, 255, 0.1); }
        .program-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .program-name { font-size: 1.4em; font-weight: 600; color: #007bff; }
        .program-price { font-size: 1.5em; font-weight: bold; color: #28a745; }
        .program-details span { display: inline-block; margin-right: 15px; font-size: 0.9em; color: #6c757d; }
        .program-details .badge { font-size: 0.85em; padding: 5px 10px; }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>


<div class="card">
    <h1><i class="fas fa-running"></i> Program Enrollment</h1>
    <p class="subtitle">Select a program below to begin your enrollment.</p>

    <div th:if="${success}" class="alert alert-success" role="alert" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-danger" role="alert" th:text="${error}"></div>
    
    <form th:action="@{/member/enroll}" method="post">
        
        <div th:if="${programs == null or programs.isEmpty()}" class="alert alert-info">
            No active programs are available for enrollment at this time.
        </div>
        
        <div th:if="${programs != null and !programs.isEmpty()}">
            <div th:each="program : ${programs}" class="program-item">
                <div class="program-header">
                    <span class="program-name" th:text="${program.name}">Program Name</span>
                    <span class="program-price" th:text="'RM ' + ${#numbers.formatDecimal(program.price, 1, 2)}">RM 150.00</span>
                </div>
                
                <p th:text="${program.description}"></p>
                
                <div class="program-details">
                    <span>Duration: <strong th:text="${program.durationWeeks} + ' weeks'">8 weeks</strong></span>
                    <span>Level: 
                        <span th:class="|badge bg-info|" th:text="${program.difficultyLevel ?: 'N/A'}">Intermediate</span>
                    </span>
                    <span th:if="${program.trainer != null}">Trainer: 
                        <strong th:text="${program.trainer.name}">Jane Doe</strong>
                    </span>
                </div>
                
                <button type="submit" name="programId" th:value="${program.id}" class="btn btn-primary mt-3 w-100">
                    Enroll Now
                </button>
            </div>
        </div>
    </form>
</div>

<script src="https://kit.fontawesome.com/your-font-awesome-kit.js" crossorigin="anonymous"></script> 
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\member\my-enrollments.html
Size: 6.28 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : My Enrollments</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .container-custom { 
            max-width: 1200px; 
            margin: 0 auto; 
        }
        h1 { 
            text-align: center; 
            color: #17477c; 
            margin-bottom: 5px; 
            font-weight: 700;
        }
        .subtitle { 
            text-align: center; 
            color: #6c757d; 
            margin-bottom: 40px; 
        }
        .enrollment-card {
            background-color: #ffffff;
            border-left: 5px solid #007bff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            padding: 20px;
        }
        .program-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }
        .status-badge {
            font-weight: bold;
            padding: 0.5em 0.8em;
            border-radius: 5px;
            font-size: 0.85em;
        }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

        <div class="container-custom">
            <h1>My Program Enrollments</h1>
            <p class="subtitle">A list of all programs you have joined, along with their status and payment details.</p>

            <!-- Empty State -->
            <div th:if="${enrollments == null or enrollments.isEmpty()}" class="alert alert-info text-center">
                You are not currently enrolled in any program. 
                <a th:href="@{/member/enroll-form}">Click here to explore and enroll in a program!</a>
            </div>

            <!-- Enrollment Cards - SIMPLE VERSION -->
            <div th:unless="${enrollments == null or enrollments.isEmpty()}">
                <div th:each="enrollment : ${enrollments}" class="enrollment-card">
                    <div class="row align-items-center">
                        
                        <!-- Program Info -->
                        <div class="col-md-5">
                            <div class="program-title" 
                                 th:text="${enrollment.program.name}">
                                Program Name
                            </div>
                            <p class="text-muted" 
                               th:text="${enrollment.program.description}">
                                Short description of the program.
                            </p>
                        </div>
                        
                        <!-- Dates - SIMPLE VERSION -->
                        <div class="col-md-4">
                            <p class="mb-1">
                                Enrollment Date: 
                                <strong th:text="${#temporals.format(enrollment.enrollmentDate, 'dd-MMM-yyyy')}">
                                    10-Dec-2025
                                </strong>
                            </p>
                            <p class="mb-1">
                                Start Date: 
                                <strong th:text="${enrollment.startDate != null ? #temporals.format(enrollment.startDate, 'dd-MMM-yyyy') : 'TBD'}">
                                    17-Dec-2025
                                </strong>
                            </p>
                            <p class="mb-1">
                                End Date: 
                                <strong th:text="${enrollment.endDate != null ? #temporals.format(enrollment.endDate, 'dd-MMM-yyyy') : 'N/A'}">
                                    N/A
                                </strong>
                            </p>
                        </div>

                        <!-- Status & Payment -->
                        <div class="col-md-3 text-end">
                            <p class="mb-2">
                                Program Status: 
                                <span class="status-badge text-white"
                                    th:classappend="${enrollment.status == 'Active' ? 'bg-success' : enrollment.status == 'Completed' ? 'bg-primary' : 'bg-danger'}" 
                                    th:text="${enrollment.status}">
                                    Active
                                </span>
                            </p>
                            <p class="mb-2">
                                Payment Status: 
                                <span class="status-badge text-dark"
                                    th:classappend="${enrollment.paymentStatus == 'Paid' ? 'bg-info' : 'bg-warning'}" 
                                    th:text="${enrollment.paymentStatus}">
                                    Pending
                                </span>
                            </p>
                            <p class="mb-0 price">
                                Amount Paid: 
                                <strong class="text-success" 
                                        th:text="'RM ' + ${#numbers.formatDecimal(enrollment.amountPaid, 1, 2)}">
                                    RM 250.00
                                </strong>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Notes Section -->
                    <div th:if="${enrollment.notes != null and enrollment.notes != ''}" class="mt-3 pt-3 border-top">
                        <small class="text-muted">Notes: <span th:text="${enrollment.notes}">Trainer notes here.</span></small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\member\program-list.html
Size: 5.15 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : Program Catalog</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f6f8fb;
            padding: 20px;
        }

        .container-custom {
            max-width: 1000px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #17477c;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .subtitle {
            text-align: center;
            color: #6c757d;
            margin-bottom: 40px;
        }

        .program-card {
            background: #fff;
            border-left: 5px solid #007bff;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
        }

        .program-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
        }

        .program-name {
            font-size: 1.6em;
            color: #007bff;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .program-description {
            font-size: 0.95em;
            color: #555;
            margin-bottom: 15px;
            flex-grow: 1; /* This helps maintain consistent card heights */
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding-top: 15px;
            border-top: 1px solid #eee;
            margin-top: 10px;
        }

        .detail-item {
            font-size: 0.9em;
            color: #333;
        }

        .detail-item strong {
            font-weight: 700;
            color: #007bff;
        }

        .price {
            font-size: 1.2em;
            font-weight: bold;
            color: #28a745;
        }

        .btn-enroll-link {
            display: block;
            width: 100%;
            padding: 10px;
            margin-top: 15px;
            font-weight: 600;
        }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>

    <div class="container-custom mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

        <h1><i class="fas fa-list-alt"></i> Available Fitness Programs</h1>
        <p class="subtitle">Explore all programs offered by HealthHub@UTM. Click "Enroll" to join!</p>

        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert" th:text="${success}"></div>
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert" th:text="${error}"></div>

        <div th:if="${programs == null or programs.isEmpty()}" class="alert alert-warning text-center">
            There are currently no active programs available. Please check back later!
        </div>

        <div class="row">
            <div th:each="program : ${programs}" class="col-md-6 col-lg-4 mb-4">
                <div class="program-card h-100">
                    <div>
                        <div class="program-name" th:text="${program.name}">Summer Shred</div>
                        <p class="program-description" th:text="${program.description}">
                            A 12-week intensive program focused on fat loss and building lean muscle mass. Includes personalized nutrition guidance.
                        </p>
                    </div>

                    <div class="info-row">
                        <div class="detail-item">
                            Duration: <strong th:text="${program.durationWeeks} + ' weeks'">12 weeks</strong>
                        </div>
                        <div class="detail-item">
                            Level: <span class="badge bg-primary" th:text="${program.difficultyLevel ?: 'General'}">Advanced</span>
                        </div>
                    </div>

                    <div class="info-row">
                        <div class="detail-item">
                            Trainer: <strong th:text="${program.trainer != null ? program.trainer.name : 'N/A'}">Jane Smith</strong>
                        </div>
                        <div class="price" th:text="'RM ' + ${#numbers.formatDecimal(program.price, 1, 2)}">RM 250.00</div>
                    </div>

                    <a th:href="@{/member/enroll-form}" class="btn btn-outline-primary btn-enroll-link">
                        Enroll Now
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://kit.fontawesome.com/your-font-awesome-kit.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\member\workout-plans.html
Size: 6.75 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>HealthHub@UTM : My Workout Plans</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .container-custom { 
            max-width: 1000px; 
            margin: 0 auto; 
        }
        h1 { 
            text-align: center; 
            color: #17477c; 
            margin-bottom: 5px; 
            font-weight: 700;
        }
        .subtitle { 
            text-align: center; 
            color: #6c757d; 
            margin-bottom: 30px; 
        }
        .plan-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e0e0e0;
        }
        /* Style for the CURRENT Active Plan */
        .plan-card.current {
            border: 3px solid #007bff; /* Primary accent */
            box-shadow: 0 8px 25px rgba(0, 123, 255, 0.2);
        }
        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .plan-name {
            font-size: 1.6em;
            font-weight: 700;
            color: #333;
        }
        .plan-badge {
            font-size: 0.9em;
            font-weight: 600;
            padding: 5px 12px;
            border-radius: 50px;
        }
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px 20px;
            margin-bottom: 20px;
            font-size: 0.9em;
            color: #555;
        }
        .exercises-content {
            background-color: #f8f9fa;
            border: 1px dashed #ced4da;
            border-radius: 8px;
            padding: 15px;
            white-space: pre-wrap; /* Crucial to respect line breaks in the TEXT field */
            font-family: monospace;
            font-size: 0.95em;
            line-height: 1.5;
        }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>


<div class="container-custom">
    <h1><i class="fas fa-running"></i> My Assigned Workout Plans</h1>
    <p class="subtitle">View the current and past workout routines assigned by your trainer.</p>

    <h2 class="mt-4 mb-3 text-primary">Current Active Plan</h2>

    <div th:if="${currentPlan == null}" class="alert alert-warning text-center">
        You do not have an active workout plan assigned. Please contact your trainer.
    </div>

    <div th:if="${currentPlan != null}" class="plan-card current">
        <div class="plan-header">
            <span class="plan-name" th:text="${currentPlan.name}">Plan Name</span>
            <span class="plan-badge bg-primary text-white">CURRENTLY ACTIVE</span>
        </div>

        <div class="details-grid">
            <div>
                <strong>Goal:</strong> <span th:text="${currentPlan.goal ?: 'N/A'}">Muscle Gain</span>
            </div>
            <div>
                <strong>Trainer:</strong> <span th:text="${currentPlan.trainer != null ? currentPlan.trainer.name : 'Unassigned'}">Coach Alex</span>
            </div>
            <div>
                <strong>Duration:</strong> 
                <span th:if="${currentPlan.startDate != null and currentPlan.endDate != null}">
                    <span th:text="${#temporals.format(currentPlan.startDate, 'dd MMM')}">01 Jan</span> - 
                    <span th:text="${#temporals.format(currentPlan.endDate, 'dd MMM yyyy')}">31 Mar 2026</span>
                </span>
                <span th:unless="${currentPlan.startDate != null and currentPlan.endDate != null}">Ongoing</span>
            </div>
        </div>
        
        <p th:if="${currentPlan.description}" class="text-muted" th:text="${currentPlan.description}"></p>

        <h5 class="mt-4">Exercises & Routine Details:</h5>
        <div class="exercises-content">
            <span th:text="${currentPlan.exercises ?: 'No detailed routine provided yet.'}">
                Day 1: Upper Body (Bench Press 3x10, Row 3x12)
                Day 2: Lower Body (Squat 4x8, Lunges 3x10)
                Day 3: Rest/Cardio
            </span>
        </div>
        
        <h5 th:if="${currentPlan.notes}" class="mt-4">Trainer Notes:</h5>
        <p th:if="${currentPlan.notes}" class="text-info" th:text="${currentPlan.notes}"></p>
    </div>

    <h2 class="mt-5 mb-3 text-secondary">Past / Inactive Plans</h2>
    
        <div th:with="inactivePlans=${allPlans.?[isActive == false]}">
            <div th:if="${inactivePlans.isEmpty()}" class="alert alert-light text-center">
            No past workout plans found.
        </div>
        
        <div th:each="plan : ${inactivePlans}" class="plan-card">
            <div class="plan-header">
                <span class="plan-name" th:text="${plan.name}">Past Plan</span>
                <span class="plan-badge bg-secondary text-white" 
                      th:text="${plan.isActive ? 'Active' : 'Inactive'}">Inactive</span>
            </div>
            
            <div class="details-grid">
                <div>
                    <strong>Goal:</strong> <span th:text="${plan.goal ?: 'N/A'}"></span>
                </div>
                <div>
                    <strong>Trainer:</strong> <span th:text="${plan.trainer != null ? plan.trainer.name : 'Unassigned'}"></span>
                </div>
                <div>
                    <strong>Completed:</strong> <span th:text="${plan.endDate != null ? #temporals.format(plan.endDate, 'dd MMM yyyy') : 'N/A'}"></span>
                </div>
            </div>
            
            <details class="mt-3">
                <summary>View Routine</summary>
                <div class="exercises-content mt-2">
                    <span th:text="${plan.exercises ?: 'No routine details available for this past plan.'}"></span>
                </div>
            </details>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/your-font-awesome-kit.js" crossorigin="anonymous"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\register.html
Size: 6.42 kB
================================================================================

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Register - HealthHub@UTM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f6f8fb; 
            padding: 20px; 
        }
        .register-container {
            max-width: 600px;
            margin: 30px auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1 {
            color: #17477c;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        .form-label {
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }
        .required::after {
            content: " *";
            color: red;
        }
        .btn-register {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            font-weight: 600;
            margin-top: 20px;
        }
        .login-link {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
        }
    </style>
</head>
<body>

<div class="register-container">
    <h1>🎯 Join HealthHub@UTM</h1>
    <p class="text-center text-muted mb-4">Create your free account to get started</p>

    <!-- Error Message -->
    <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
        <strong>❌ Error:</strong> <span th:text="${errorMessage}"></span>
    </div>

    <!-- Registration Form -->
    <form th:action="@{/register}" th:object="${member}" method="post">
        
        <!-- Full Name -->
        <div class="mb-3">
            <label for="name" class="form-label required">Full Name</label>
            <input type="text" 
                   id="name" 
                   th:field="*{name}" 
                   class="form-control" 
                   placeholder="Enter your full name"
                   required>
        </div>

        <!-- Username -->
        <div class="mb-3">
            <label for="username" class="form-label required">Username</label>
            <input type="text" 
                   id="username" 
                   th:field="*{username}" 
                   class="form-control" 
                   placeholder="Choose a unique username"
                   required>
            <small class="text-muted">This will be used to log in</small>
        </div>

        <!-- Password -->
        <div class="mb-3">
            <label for="password" class="form-label required">Password</label>
            <input type="password" 
                   id="password" 
                   th:field="*{password}" 
                   class="form-control" 
                   placeholder="Create a strong password"
                   required>
        </div>

        <!-- Email -->
        <div class="mb-3">
            <label for="email" class="form-label required">Email Address</label>
            <input type="email" 
                   id="email" 
                   th:field="*{email}" 
                   class="form-control" 
                   placeholder="your.email@example.com"
                   required>
        </div>

        <!-- Phone -->
        <div class="mb-3">
            <label for="phone" class="form-label">Phone Number</label>
            <input type="text" 
                   id="phone" 
                   th:field="*{phone}" 
                   class="form-control"
                   placeholder="01X-XXXXXXX">
        </div>

        <!-- Year of Birth -->
        <div class="mb-3">
            <label for="yearOfBirth" class="form-label required">Year of Birth</label>
            <input type="number" 
                   id="yearOfBirth" 
                   th:field="*{yearOfBirth}" 
                   class="form-control" 
                   min="1900" 
                   max="2025" 
                   placeholder="e.g., 1995"
                   required>
        </div>

        <!-- Gender -->
        <div class="mb-3">
            <label class="form-label required">Gender</label><br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" 
                       type="radio" 
                       th:field="*{gender}" 
                       value="Male" 
                       id="genderMale"
                       required>
                <label class="form-check-label" for="genderMale">Male</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" 
                       type="radio" 
                       th:field="*{gender}" 
                       value="Female" 
                       id="genderFemale"
                       required>
                <label class="form-check-label" for="genderFemale">Female</label>
            </div>
        </div>

        <!-- Member Type -->
        <div class="mb-3">
            <label for="memberType" class="form-label required">I am a</label>
            <select id="memberType" 
                    th:field="*{memberType}" 
                    class="form-select" 
                    required>
                <option value="">-- Select --</option>
                <option value="student">Student</option>
                <option value="staff">Staff</option>
                <option value="public">Public</option>
            </select>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-success btn-register">
            ✅ Create Account
        </button>
    </form>

    <!-- Login Link -->
    <div class="login-link">
        <p class="text-muted mb-0">Already have an account? 
            <a th:href="@{/login}" class="text-decoration-none fw-bold">Login here</a>
        </p>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\trainer\dashboard.html
Size: 5.85 kB
================================================================================

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>Trainer Dashboard</title>    
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f6; margin: 20px; }
        
        /* --- CARDS --- */
        .dashboard-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            height: 100%;
            transition: transform 0.2s;
        }
        .dashboard-card:hover { transform: translateY(-2px); }
        
        /* --- STATS --- */
        .stat-label { color: #6c757d; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-value { font-size: 2rem; font-weight: bold; color: #007bff; }
        
        /* --- PROFILE --- */
        .profile-header { border-bottom: 2px solid #007bff; padding-bottom: 15px; margin-bottom: 20px; }
        .profile-name { font-size: 1.8rem; font-weight: bold; color: #333; margin: 0; }
        .profile-role { color: #007bff; font-weight: 500; font-size: 1.1rem; }
        
        .info-label { font-weight: bold; color: #555; width: 140px; display: inline-block; }
        .info-row { margin-bottom: 12px; border-bottom: 1px solid #eee; padding-bottom: 8px; }
        
        /* --- BUTTONS --- */
        .btn-action { width: 100%; margin-bottom: 10px; padding: 15px; font-size: 1.1rem; border-radius: 8px; }
    </style>
</head>

<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

    <div class="container" style="max-width: 1100px;">
        
        <div class="row mb-4">
            <div class="col-12">
                <div class="dashboard-card">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h1 class="profile-name" th:text="${'Welcome back, ' + trainer.name}">Welcome back, Trainer</h1>
                            <span class="profile-role" th:text="${trainer.specialization}">Specialization Here</span>
                        </div>
                        <div class="text-end">
                            <span class="badge bg-success" th:if="${trainer.isActive}">Active Status</span>
                            <span class="badge bg-danger" th:unless="${trainer.isActive}">Inactive</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-4">
                <div class="dashboard-card text-center">
                    <div class="stat-label">Experience</div>
                    <div class="stat-value">
                        <span th:text="${trainer.yearsOfExperience}">0</span> <small style="font-size:1rem;">Years</small>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="dashboard-card text-center">
                    <div class="stat-label">Active Plans</div>
                    <div class="stat-value" th:text="${planCount}">0</div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="dashboard-card text-center">
                    <div class="stat-label">Top Certification</div>
                    <div style="font-size: 1.2rem; font-weight: bold; color: #333; margin-top: 10px;" 
                         th:text="${trainer.certification}">
                        None
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-8">
                <div class="dashboard-card">
                    <h4 class="profile-header">👤 My Profile Details</h4>
                    
                    <div class="info-row">
                        <span class="info-label">Email:</span>
                        <span th:text="${trainer.email}">email@example.com</span>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">Phone:</span>
                        <span th:text="${trainer.phone}">+123456789</span>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">Username:</span>
                        <span th:text="${trainer.username}">user123</span>
                    </div>

                    <div class="mt-4">
                        <span class="info-label" style="margin-bottom: 5px; display:block;">Biography:</span>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; color: #555;">
                            <span th:text="${trainer.bio}">No biography provided yet.</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="dashboard-card">
                    <h4 class="profile-header">⚡ Quick Actions</h4>
                    
                    <a th:href="@{/trainer/plans}" class="btn btn-primary btn-action">
                        📋 Manage Plans
                    </a>

                    <hr>
                    
                    <a th:href="@{/logout}" class="btn btn-outline-danger btn-action">
                        Logout
                    </a>
                </div>
            </div>
        </div>

    </div>

</body>
</html>


================================================================================
File: main\webapp\WEB-INF\views\trainer\plan-create.html
Size: 6.68 kB
================================================================================

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>Create New Workout Plan</title>
    
    <style>
        /* --- GENERAL LAYOUT --- */
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #f4f7f6; 
        }
        .container { 
            max-width: 800px; /* Slightly narrower for a form */
            margin: 0 auto; 
            background-color: white; 
            padding: 30px; 
            border-radius: 8px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); 
        }
        
        /* --- HEADERS --- */
        h1 { 
            color: #333; 
            border-bottom: 2px solid #007bff; 
            padding-bottom: 10px; 
            margin-bottom: 25px; 
        }
        
        /* --- FORM ELEMENTS --- */
        fieldset {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 4px;
            background-color: #fafafa;
        }
        legend {
            font-size: 1.1em;
            font-weight: bold;
            color: #007bff;
            padding: 0 10px;
            width: auto; /* Fix for Bootstrap legend width */
            float: none; /* Fix for Bootstrap legend float */
        }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        
        input[type="text"], input[type="date"], textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea { resize: vertical; min-height: 100px; }
        
        /* Error Text */
        .error { color: #dc3545; font-size: 0.9em; margin-top: 5px; display: block; }
        
        /* --- BUTTONS --- */
        .button-group { margin-top: 30px; text-align: right; }
        .save-button { background-color: #28a745; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; margin-right: 10px; }
        .cancel-button { background-color: #6c757d; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; cursor: pointer; font-size: 16px; display: inline-block; }
        .save-button:hover, .cancel-button:hover { opacity: 0.9; color: white; }
    </style>
</head>

<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

    <div class="container">
        <h1 th:text="${workoutPlan.id == null} ? '📝 Create New Workout Plan' : '✏️ Edit Workout Plan'">
            📝 Create New Workout Plan
        </h1>
        
        <form th:action="${workoutPlan.id == null} ? @{/trainer/plans/save} : @{/trainer/plans/update}" 
            th:object="${workoutPlan}" 
            method="post">

            <input type="hidden" th:field="*{id}" />
            
            <input type="hidden" th:field="*{createdDate}" />
            <input type="hidden" th:field="*{isActive}" />
            <fieldset>
                <legend>Plan Details</legend>
                <div class="form-group">
                    <label for="name">Plan Name <span style="color:red;">*</span></label>
                    <input type="text" id="name" th:field="*{name}" placeholder="e.g., 8-Week Strength Cycle" required />
                    <span th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="error"></span>
                </div>

                <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" th:field="*{description}" placeholder="Brief overview of the plan's methodology..."></textarea>
                </div>
            </fieldset>
            
            <fieldset>
                <legend>Assignment & Goal</legend>
                <div class="form-group">
                    <label for="personId">Assign to Member <span style="color:red;">*</span></label>
                    
                    <select id="personId" name="personId" required>
                        <option value="" disabled selected>-- Select Member --</option>
                        <option th:each="member : ${members}" 
                                th:value="${member.id}" 
                                th:text="${member.name}">John Doe</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="goal">Goal</label>
                    <input type="text" id="goal" th:field="*{goal}" placeholder="e.g., Run a 5K, Lose 5kg" />
                </div>
            </fieldset>

            <fieldset>
                <legend>Schedule</legend>
                <div class="row"> <div class="col-md-6">
                        <div class="form-group">
                            <label for="startDate">Start Date</label>
                            <input type="date" id="startDate" th:field="*{startDate}" />
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="endDate">End Date</label>
                            <input type="date" id="endDate" th:field="*{endDate}" />
                        </div>
                    </div>
                </div>
            </fieldset>

            <fieldset>
                <legend>Workout Content</legend>
                <div class="form-group">
                    <label for="exercises">Exercises (Detailed Plan)</label>
                    <textarea id="exercises" th:field="*{exercises}" placeholder="Day 1: Squats (3x10), Bench Press (3x10)..." style="min-height: 150px;"></textarea>
                </div>

                <div class="form-group">
                    <label for="notes">Trainer Notes</label>
                    <textarea id="notes" th:field="*{notes}" placeholder="Remind client about nutrition, watch form..."></textarea>
                </div>
            </fieldset>

            <div class="button-group">
                <button type="submit" class="save-button">Save Plan</button>
                <a th:href="@{/trainer/plans}" class="cancel-button">Cancel</a>
            </div>
        </form>
    </div>

</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\trainer\plan-list.html
Size: 6.36 kB
================================================================================

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
 
<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>Trainer - Workout Plans</title>
    
    <style>
        /* --- GENERAL LAYOUT --- */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px; 
            background-color: #f4f7f6; 
        }
        .container { 
            max-width: 1100px; 
            margin: 0 auto; 
            background-color: white; 
            padding: 30px; 
            border-radius: 8px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); 
        }
        
        /* --- HEADER --- */
        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        h1 { color: #333; margin: 0; font-size: 28px; }
        
        /* --- TABLE STYLES --- */
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 20px; 
        }
        th { 
            padding: 15px; 
            text-align: left; 
            background-color: #f8f9fa;
            font-weight: bold; 
            color: #333; 
            border-bottom: 1px solid #dee2e6;
        }
        td { 
            padding: 15px; 
            text-align: left; 
            border-bottom: 1px solid #eee; 
            vertical-align: middle; 
        }
        tr:hover { background-color: #f9f9f9; }

        /* --- DATE STACKING --- */
        .date-stack {
            font-size: 0.9em;
            color: #555;
        }
        .date-label {
            font-weight: bold;
            font-size: 0.8em;
            color: #777;
            text-transform: uppercase;
        }

        /* --- VERTICAL BUTTON STACK --- */
        .actions-cell {
            width: 120px; /* Narrow width for vertical stack */
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column; /* ⬇️ STACKS BUTTONS VERTICALLY */
            gap: 5px; 
        }

        .btn-custom { 
            width: 100%;        /* Make buttons fill the width */
            text-align: center; 
            padding: 6px 0; 
            border: none; 
            border-radius: 4px; 
            text-decoration: none; 
            cursor: pointer; 
            font-size: 13px;  
            color: white;
            font-weight: 500;
            display: block;
        }
        .btn-custom:hover { opacity: 0.9; color: white; }

        /* Colors */
        .btn-create { background-color: #28a745; font-size: 16px; padding: 10px 20px; width: auto; display: inline-block;} 
        .btn-view   { background-color: #17a2b8; }
        .btn-edit   { background-color: #ffc107; color: #212529; }
        .btn-delete { background-color: #dc3545; }

        /* Alerts */
        .alert { 
            padding: 15px; 
            background-color: #d4edda; 
            color: #155724; 
            border: 1px solid #c3e6cb; 
            border-radius: 4px; 
            margin-bottom: 20px; 
        }
        .empty-state { text-align: center; padding: 40px; color: #777; font-style: italic; }
    </style>
</head>
<body>

    <div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>


<div class="container">
    
    <div class="header-row">
        <h1>📋 Client Workout Plans</h1>
        <a th:href="@{/trainer/plans/new}" class="btn-custom btn-create">+ Create New Plan</a>
    </div>
    
    <div th:if="${message}" class="alert">
        <span th:text="${message}">Action successful!</span>
    </div>

    <table>
        <thead>
            <tr>
                <th>Plan Name</th>
                <th>Member</th>
                <th>Goal</th>
                <th>Schedule</th> 
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="plan : ${plans}">
                
                <td th:text="${plan.name}" style="font-weight: 500;">Strength Program</td>
                <td th:text="${plan.member != null} ? ${plan.member.name} : 'Unassigned'">John Doe</td>
                <td th:text="${plan.goal}">Weight Loss</td>
                
                <td>
                    <div class="date-stack">
                        <span class="date-label">Start:</span> <span th:text="${plan.startDate}">2025-01-01</span><br>
                        <span class="date-label">End:</span> &nbsp; <span th:text="${plan.endDate}">2025-02-01</span>
                    </div>
                </td>

                <td th:text="${plan.isActive} ? 'Active' : 'Ended'">Active</td>
                
                <td class="actions-cell">
                    <div class="action-buttons">
                        <a th:href="@{/trainer/plans/view/{id}(id=${plan.id})}" class="btn-custom btn-view">View</a>
                        
                        <a th:href="@{/trainer/plans/edit/{id}(id=${plan.id})}" class="btn-custom btn-edit">Edit</a>
                        
                        <form th:action="@{/trainer/plans/delete}" method="post" style="width: 100%;">
                            <input type="hidden" name="id" th:value="${plan.id}" />
                            <button type="submit" class="btn-custom btn-delete" 
                                    style="width: 100%;"
                                    onclick="return confirm('Are you sure you want to delete this plan?');">
                                Delete
                            </button>
                        </form>
                    </div>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(plans)}">
                <td colspan="6" class="empty-state">
                    No workout plans found. Click "Create New Plan" to get started!
                </td>
            </tr>
        </tbody>
    </table>
</div>

</body>
</html>

================================================================================
File: main\webapp\WEB-INF\views\trainer\plan-view.html
Size: 8.96 kB
================================================================================

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <div th:insert="~{fragments :: common-head}"></div>
    <title>View Workout Plan</title>

    <style>
        /* --- GENERAL LAYOUT --- */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px; 
            background-color: #f4f7f6; 
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            padding-bottom: 40px;
        }

        /* --- CARDS --- */
        .info-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 25px;
        }
        
        /* --- HEADER SECTION --- */
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #007bff;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        h1 { margin: 0; color: #333; font-size: 28px; }
        .subtitle { color: #666; font-size: 0.9em; margin-top: 5px; }

        /* --- STATUS BADGES --- */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            text-transform: uppercase;
        }
        .bg-active { background-color: #d1e7dd; color: #0f5132; }
        .bg-ended { background-color: #e2e3e5; color: #383d41; }

        /* --- LABELS & VALUES --- */
        .label { font-weight: bold; color: #555; display: block; margin-bottom: 3px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .value { font-size: 1.1rem; color: #222; margin-bottom: 15px; }
        .big-value { font-size: 1.5rem; font-weight: bold; color: #007bff; }

        /* --- PROGRESS MONITOR SECTION --- */
        .progress-box {
            background-color: #f8f9fa;
            border-left: 5px solid #28a745; /* Green accent */
            padding: 15px;
            border-radius: 4px;
        }
        .bmi-box {
            background-color: white;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }

        /* --- TEXT AREAS (READ ONLY) --- */
        .text-content {
            background-color: #fcfcfc;
            border: 1px solid #eee;
            padding: 15px;
            border-radius: 6px;
            white-space: pre-wrap; /* Preserves line breaks from the textarea */
            color: #444;
            min-height: 100px;
        }

        /* --- BUTTONS --- */
        .btn-custom {
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
            font-weight: 500;
            border: none;
            cursor: pointer;
        }
        .btn-edit { background-color: #ffc107; color: #212529; }
        .btn-back { background-color: #6c757d; color: white; }
        .btn-delete { background-color: #dc3545; color: white; }
        .btn-custom:hover { opacity: 0.9; }

        .btn-group-custom {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
    </style>
</head>

<body>

<div th:replace="~{fragments :: main-menu}"></div>
    
    <div class="container mt-4">
        <div th:replace="~{fragments :: flash-messages}"></div>

<div class="container">

    <div class="info-card">
        <div class="header-section">
            <div>
                <h1><span th:text="${plan.name}">Plan Name</span></h1>
                <div class="subtitle">Created on: <span th:text="${plan.createdDate}">2023-01-01</span></div>
            </div>
            
            <span class="status-badge" 
                  th:classappend="${plan.isActive} ? 'bg-active' : 'bg-ended'"
                  th:text="${plan.isActive} ? 'ACTIVE PLAN' : 'PLAN ENDED'">
                ACTIVE
            </span>
        </div>

        <div class="row">
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-6">
                        <span class="label">Goal</span>
                        <div class="value" th:text="${plan.goal}">Lose Weight</div>
                    </div>
                    <div class="col-md-6">
                        <span class="label">Duration</span>
                        <div class="value">
                            <span th:text="${plan.startDate}"></span> 
                            &nbsp;➔&nbsp; 
                            <span th:text="${plan.endDate}"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <span class="label">Description</span>
                    <p class="value" th:text="${plan.description}">No description provided.</p>
                </div>
            </div>

            <div class="col-md-4">
                <div class="progress-box">
                    <h5 style="margin-top:0; color: #28a745;">👤 Member Monitor</h5>
                    <hr style="margin: 5px 0 15px 0;">
                    
                    <div th:if="${plan.member != null}">
                        <div class="mb-2">
                            <span class="label">Name</span>
                            <strong style="font-size: 1.1em;" th:text="${plan.member.name}">John Doe</strong>
                        </div>

                        <div class="row g-2">
                            <div class="col-6">
                                <div class="bmi-box">
                                    <span class="label">Weight</span>
                                    <div class="big-value" style="font-size: 1.2em; color: #333;">
                                        <span th:text="${plan.member.weight}">70</span> kg
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="bmi-box">
                                    <span class="label">Current BMI</span>
                                    <div class="big-value" style="font-size: 1.2em;" 
                                         th:text="${#numbers.formatDecimal(plan.member.bmi, 1, 1)}">
                                        22.5
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 10px; text-align: center;">
                            <span th:if="${plan.member.bmi < 18.5}" class="badge bg-warning text-dark">Underweight</span>
                            <span th:if="${plan.member.bmi >= 18.5 && plan.member.bmi < 25}" class="badge bg-success">Normal Weight</span>
                            <span th:if="${plan.member.bmi >= 25}" class="badge bg-danger">Overweight</span>
                        </div>
                    </div>

                    <div th:if="${plan.member == null}" class="text-muted">
                        <em>Unassigned</em>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="info-card">
        <h4 style="margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px;">🏋️ Workout Instructions</h4>
        
        <div class="mb-4">
            <span class="label">Detailed Exercises</span>
            <div class="text-content" th:text="${plan.exercises}">
                Day 1: Squats...
            </div>
        </div>

        <div class="mb-2">
            <span class="label">Trainer Notes</span>
            <div class="text-content" style="background-color: #fffde7; border-color: #fff9c4;" th:text="${plan.notes}">
                Remember to rest...
            </div>
        </div>
    </div>

    <div class="btn-group-custom">
        <a th:href="@{/trainer/plans}" class="btn-custom btn-back">← Back to List</a>
        
        <a th:href="@{/trainer/plans/edit/{id}(id=${plan.id})}" class="btn-custom btn-edit">✎ Edit Plan</a>
        
        <form th:action="@{/trainer/plans/delete}" method="post" style="display:inline;">
            <input type="hidden" name="id" th:value="${plan.id}" />
            <button type="submit" class="btn-custom btn-delete" 
                    onclick="return confirm('Are you sure you want to delete this plan?');">
                🗑 Delete
            </button>
        </form>
    </div>

</div>

</body>
</html>

================================================================================
File: main\webapp\WEB-INF\web.xml
Size: 1.01 kB
================================================================================

<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                             http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">

    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>

    <error-page>
    <error-code>404</error-code>
    <location>/error/404.html</location>
</error-page>
<error-page>
    <error-code>500</error-code>
    <location>/error/500.html</location>
</error-page>

</web-app>

